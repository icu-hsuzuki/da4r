<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 12 Assignment Four | Data Analysis for Researchers AY2022</title>
<meta name="author" content="Hiroshi Suzuki">
<meta name="description" content="Assignment Four: The Week Five Assignment tidyr and WIR2022 Create an R Notebook of a Data Analysis containing the following and submit the rendered HTML file (e.g., a3_123456.nb.html by replacing...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 12 Assignment Four | Data Analysis for Researchers AY2022">
<meta property="og:type" content="book">
<meta property="og:url" content="https://icu-hsuzuki.github.io/da4r2022/a4resp.html">
<meta property="og:description" content="Assignment Four: The Week Five Assignment tidyr and WIR2022 Create an R Notebook of a Data Analysis containing the following and submit the rendered HTML file (e.g., a3_123456.nb.html by replacing...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 12 Assignment Four | Data Analysis for Researchers AY2022">
<meta name="twitter:description" content="Assignment Four: The Week Five Assignment tidyr and WIR2022 Create an R Notebook of a Data Analysis containing the following and submit the rendered HTML file (e.g., a3_123456.nb.html by replacing...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.27/datatables.js"></script><link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Analysis for Researchers AY2022</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li class="book-part">PART I. INTRODUCTION</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> About the Course</a></li>
<li><a class="" href="randrstudio.html"><span class="header-section-number">2</span> R and R Studio</a></li>
<li><a class="" href="tidyverse.html"><span class="header-section-number">3</span> tidyverse</a></li>
<li><a class="" href="rmarkdown.html"><span class="header-section-number">4</span> R Markdown</a></li>
<li><a class="" href="dplyr.html"><span class="header-section-number">5</span> dplyr</a></li>
<li><a class="" href="a2resp.html"><span class="header-section-number">6</span> Assignment Two</a></li>
<li><a class="" href="wdidata.html"><span class="header-section-number">7</span> WDI</a></li>
<li><a class="" href="ggplot2.html"><span class="header-section-number">8</span> ggplot2</a></li>
<li><a class="" href="a3resp.html"><span class="header-section-number">9</span> Assignment Three</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">10</span> tidyr</a></li>
<li><a class="" href="workflow.html"><span class="header-section-number">11</span> Workflow</a></li>
<li><a class="active" href="a4resp.html"><span class="header-section-number">12</span> Assignment Four</a></li>
<li><a class="" href="model.html"><span class="header-section-number">13</span> Linear Model</a></li>
<li><a class="" href="roundups.html"><span class="header-section-number">14</span> Roudups</a></li>
<li><a class="" href="a5resp.html"><span class="header-section-number">15</span> Assignment Five</a></li>
<li><a class="" href="final.html"><span class="header-section-number">16</span> Presentation and Paper</a></li>
<li class="book-part">PART II EDA BASICS</li>
<li><a class="" href="eda.html"><span class="header-section-number">17</span> Exploratory Data analysis</a></li>
<li><a class="" href="importing.html"><span class="header-section-number">18</span> Importing</a></li>
<li><a class="" href="transforming.html"><span class="header-section-number">19</span> Transforming</a></li>
<li><a class="" href="tidying.html"><span class="header-section-number">20</span> Tidying</a></li>
<li><a class="" href="visualizing.html"><span class="header-section-number">21</span> Visualizing</a></li>
<li><a class="" href="modeling.html"><span class="header-section-number">22</span> Modeling</a></li>
<li><a class="" href="communicating.html"><span class="header-section-number">23</span> Communicating</a></li>
<li class="book-part">PART III OPEN PUBLIC DATA</li>
<li><a class="" href="worldbank.html"><span class="header-section-number">24</span> World Bank</a></li>
<li><a class="" href="owid.html"><span class="header-section-number">25</span> Our World in Data</a></li>
<li><a class="" href="oecd.html"><span class="header-section-number">26</span> OECD</a></li>
<li><a class="" href="undata.html"><span class="header-section-number">27</span> UN Data</a></li>
<li><a class="" href="wir.html"><span class="header-section-number">28</span> World Inequality Report</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="histdata.html"><span class="header-section-number">A</span> HistData</a></li>
<li><a class="" href="covid19.html"><span class="header-section-number">B</span> Covid 19</a></li>
<li><a class="" href="worldmap.html"><span class="header-section-number">C</span> World Map</a></li>
<li><a class="" href="bookdown.html"><span class="header-section-number">D</span> Bookdown</a></li>
<li><a class="" href="template.html"><span class="header-section-number">E</span> Template</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/icu-hsuzuki/da4r2022">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="a4resp" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Assignment Four<a class="anchor" aria-label="anchor" href="#a4resp"><i class="fas fa-link"></i></a>
</h1>
<div id="assignment-four-the-week-five-assignment" class="section level3 unnumbered">
<h3>Assignment Four: The Week Five Assignment<a class="anchor" aria-label="anchor" href="#assignment-four-the-week-five-assignment"><i class="fas fa-link"></i></a>
</h3>
<p><strong><code>tidyr</code> and WIR2022</strong></p>
<ul>
<li>Create an R Notebook of a Data Analysis containing the following and submit the rendered HTML file (e.g., <code>a3_123456.nb.html</code> by replacing 123456 with your ID)
<ol style="list-style-type: decimal">
<li>create an R Notebook using the R Notebook Template in Moodle, save it as <code>a3_123456.Rmd</code>,</li>
<li>write your name and ID and the contents,</li>
<li>run each code block,</li>
<li>preview to create <code>a3_123456.nb.html</code>,</li>
<li>submit <code>a3_123456.nb.html</code> to Moodle.</li>
</ol>
</li>
</ul>
<ol style="list-style-type: decimal">
<li>
<p>Choose data with at least two categorical variables and at least two numerical variables.</p>
<ul>
<li>Information of the data: Name, Indicator, Description, Source, etc.</li>
<li>Explain why you chose the indicator</li>
<li>List questions you want to study</li>
</ul>
</li>
<li>
<p>Explore the data using visualization using <code>ggplot2</code>.</p>
<ul>
<li>Create various charts</li>
<li>Create at least one chart with at least two categorical variables and one numerical variable.</li>
<li>Create at least one chart with at least two numerical and one categorical variable.</li>
</ul>
</li>
<li><p>Observations based on your data visualization and difficulties and questions encountered, if any.</p></li>
</ol>
<p><strong>Due:</strong> 2023-01-23 23:59:00. Submit your R Notebook file in Moodle (The Fourth Assignment). Due on Monday!</p>
</div>
<div id="set-up-4" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Set up<a class="anchor" aria-label="anchor" href="#set-up-4"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.2     ✔ readr     2.1.4</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.0</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.4.2     ✔ tibble    3.2.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.2     ✔ tidyr     1.3.0</span></span>
<span><span class="co">#&gt; ✔ purrr     1.0.1     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span> <span class="co"># for excel files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/WDI/">WDI</a></span><span class="op">)</span></span></code></pre></div>
<div id="world-development-indicator---wdi" class="section level3" number="12.1.1">
<h3>
<span class="header-section-number">12.1.1</span> World Development Indicator - WDI<a class="anchor" aria-label="anchor" href="#world-development-indicator---wdi"><i class="fas fa-link"></i></a>
</h3>
<p>The following is useful when you use WDI.</p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wdi_cache</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://vincentarelbundock.github.io/WDI/reference/WDIcache.html">WDIcache</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Or, write the cache and read it from your computer. Since <code>wdi_cache</code> is a list of two data frames, we cannot use <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv()</a></code>; instead, we use <code>write_rds</code>.</p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">write_rds</a></span><span class="op">(</span><span class="va">wdi_cache</span>, <span class="st">"./data/wdi_cache.RData"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wdi_cache</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">"./data/wdi_cache.RData"</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="https://vincentarelbundock.github.io/WDI/reference/WDIcache.html">WDIcache()</a></code> produces a list containing two data frames: <code>wdi_cache$series</code> and <code>wdi_cache$country</code>.</p>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">wdi_cache</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ series :'data.frame': 21034 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   ..$ indicator         : chr [1:21034] "1.0.HCount.1.90usd" "1.0.HCount.2.5usd" "1.0.HCount.Mid10to50" "1.0.HCount.Ofcl" ...</span></span>
<span><span class="co">#&gt;   ..$ name              : chr [1:21034] "Poverty Headcount ($1.90 a day)" "Poverty Headcount ($2.50 a day)" "Middle Class ($10-50 a day) Headcount" "Official Moderate Poverty Rate-National" ...</span></span>
<span><span class="co">#&gt;   ..$ description       : chr [1:21034] "The poverty headcount index measures the proportion of the population with daily per capita income (in 2011 PPP"| __truncated__ "The poverty headcount index measures the proportion of the population with daily per capita income (in 2005 PPP"| __truncated__ "The poverty headcount index measures the proportion of the population with daily per capita income (in 2005 PPP"| __truncated__ "The poverty headcount index measures the proportion of the population with daily per capita income below the of"| __truncated__ ...</span></span>
<span><span class="co">#&gt;   ..$ sourceDatabase    : chr [1:21034] "LAC Equity Lab" "LAC Equity Lab" "LAC Equity Lab" "LAC Equity Lab" ...</span></span>
<span><span class="co">#&gt;   ..$ sourceOrganization: chr [1:21034] "LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank)." "LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank)." "LAC Equity Lab tabulations of SEDLAC (CEDLAS and the World Bank)." "LAC Equity Lab tabulations of data from National Statistical Offices." ...</span></span>
<span><span class="co">#&gt;  $ country:'data.frame': 299 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;   ..$ iso3c    : chr [1:299] "ABW" "AFE" "AFG" "AFR" ...</span></span>
<span><span class="co">#&gt;   ..$ iso2c    : chr [1:299] "AW" "ZH" "AF" "A9" ...</span></span>
<span><span class="co">#&gt;   ..$ country  : chr [1:299] "Aruba" "Africa Eastern and Southern" "Afghanistan" "Africa" ...</span></span>
<span><span class="co">#&gt;   ..$ region   : chr [1:299] "Latin America &amp; Caribbean" "Aggregates" "South Asia" "Aggregates" ...</span></span>
<span><span class="co">#&gt;   ..$ capital  : chr [1:299] "Oranjestad" "" "Kabul" "" ...</span></span>
<span><span class="co">#&gt;   ..$ longitude: chr [1:299] "-70.0167" "" "69.1761" "" ...</span></span>
<span><span class="co">#&gt;   ..$ latitude : chr [1:299] "12.5167" "" "34.5228" "" ...</span></span>
<span><span class="co">#&gt;   ..$ income   : chr [1:299] "High income" "Aggregates" "Low income" "Aggregates" ...</span></span>
<span><span class="co">#&gt;   ..$ lending  : chr [1:299] "Not classified" "Aggregates" "IDA" "Aggregates" ...</span></span></code></pre></div>
</div>
<div id="world-inequility-report---wir2022" class="section level3" number="12.1.2">
<h3>
<span class="header-section-number">12.1.2</span> World Inequility Report - WIR2022<a class="anchor" aria-label="anchor" href="#world-inequility-report---wir2022"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>World Inequality Report: <a href="https://wir2022.wid.world/" class="uri">https://wir2022.wid.world/</a>
</li>
<li>Executive Summary: <a href="https://wir2022.wid.world/executive-summary/" class="uri">https://wir2022.wid.world/executive-summary/</a>
</li>
<li>Methodology: <a href="https://wir2022.wid.world/methodology/" class="uri">https://wir2022.wid.world/methodology/</a>
</li>
<li>URL of Executive Summary Data: <a href="https://wir2022.wid.world/www-site/uploads/2022/03/WIR2022TablesFigures-Summary.xlsx" class="uri">https://wir2022.wid.world/www-site/uploads/2022/03/WIR2022TablesFigures-Summary.xlsx</a>
</li>
</ul>
<p>Please add <code>mode="wb"</code> (web binary). This should work better.</p>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url_summary</span> <span class="op">&lt;-</span> <span class="st">"https://wir2022.wid.world/www-site/uploads/2022/03/WIR2022TablesFigures-Summary.xlsx"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">url_summary</span>, </span>
<span>              destfile <span class="op">=</span> <span class="st">"./data/WIR2022s.xlsx"</span>, </span>
<span>              mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span> </span></code></pre></div>
<p>If you get an error, download the file directory from the methodology site into your computer, then open it with Excel and save it in the data folder of your R Studio project. Then R studio can recognize it easily as an Excel data.</p>
<p>Generally, a text file such as a CSV file is easy to import, but a binary file is difficult to handle. It is because unless R can recognize its file type, for example, Excel or so, R cannot import the data.</p>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="st">"./data/WIR2022s.xlsx"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Index"     "F1"        "F2"        "F3"       </span></span>
<span><span class="co">#&gt;  [5] "F4"        "F5."       "F6"        "F7"       </span></span>
<span><span class="co">#&gt;  [9] "F8"        "F9"        "F10"       "F11"      </span></span>
<span><span class="co">#&gt; [13] "F12"       "F13"       "F14"       "F15"      </span></span>
<span><span class="co">#&gt; [17] "T1"        "data-F1"   "data-F2"   "data-F3"  </span></span>
<span><span class="co">#&gt; [21] "data-F4"   "data-F5"   "data-F6"   "data-F7"  </span></span>
<span><span class="co">#&gt; [25] "data-F8"   "data-F9"   "data-F10"  "data-F11" </span></span>
<span><span class="co">#&gt; [29] "data-F12"  "data-F13." "data-F14." "data-F15"</span></span></code></pre></div>
</div>
</div>
<div id="general-comments-2" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> General Comments<a class="anchor" aria-label="anchor" href="#general-comments-2"><i class="fas fa-link"></i></a>
</h2>
<div id="reproducibility-and-literate-programming" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Reproducibility and Literate Programming<a class="anchor" aria-label="anchor" href="#reproducibility-and-literate-programming"><i class="fas fa-link"></i></a>
</h3>
<p>Reproducibility and Literate Programming are critical to exploratory data analysis (EDA). These are for communication; communication with readers of the paper, graders of the assignments, and communication with yourself, as we always forget. Please think about the reader of the article, and record the procedure and output so that reader can easily understand what you have done.</p>
<p>The data source is critical. Unless the reader obtains the same data quickly, the communication on EDA does not start. If the data is not downloaded automatically through the code chunk, you should explain how to obtain the data and the part of the data you applied. It is crucial when you use copying and paste using <code>read_delim(clipboard())</code>. Please describe the way for the reader to retrieve the same data easily. It is best to read your paper; in some cases, it can be a hard copy from the beginning to check whether the reader can reproduce what you have done in the article.</p>
</div>
<div id="varibles-2" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Varibles<a class="anchor" aria-label="anchor" href="#varibles-2"><i class="fas fa-link"></i></a>
</h3>
<p>In this Assignment Four, we required the following:</p>
<ul>
<li>Create at least one chart with at least two categorical variables and one numerical variable.</li>
<li>Create at least one chart with at least two numerical and one categorical variable.</li>
</ul>
<p>You can create a simple chart, such as a histogram or a box plot with only one variable. If you have two variables, you can create a scatter plot. But with <code>ggplot2</code>, you can create various charts with rich information using more than two variables. For example, the year can be used for both numerical and categorical variables using <code>factor(year)</code> or recognized as a character vector by <code>as.character(year)</code>. So the distinction between categorical variables and numerical variables is flexible. The purpose of this assignment is to experience creating a chart with rich information using more than two variables.</p>
<p>However, I needed to clarify the variables’ requirements for some of you. So I sent out an extra message from Announcement that you do not need to take it so strictly.</p>
<p>If you use WDI, the following may be examples:</p>
<ul>
<li>two categorical and one numerical: a. country, region, and indicator; b. country, income, and indicator; c. after selecting a couple of years and using factor(year), country, indicator, d. create a table using group_by and summarize this type, etc.</li>
<li>two numerical and one categorical: a. year, indicator, and country; b. two indicators and region, etc.</li>
</ul>
<p>If you use WIR, the following may be examples you saw in the executive summary:</p>
<ul>
<li><p>two categorical and one numerical: F1, F2, F4, F13 (year in this case is categorical), F15</p></li>
<li><p>two numerical and one categorical: F6, F7, F10</p></li>
<li><p>Three categorical: F3</p></li>
<li><p>Two categorical and two numerical: F8, F11</p></li>
</ul>
</div>
<div id="visualization-1" class="section level3" number="12.2.3">
<h3>
<span class="header-section-number">12.2.3</span> Visualization<a class="anchor" aria-label="anchor" href="#visualization-1"><i class="fas fa-link"></i></a>
</h3>
<p>Data visualization is a key to EDA. Create various charts and write your observations you can or cannot obtain from the chart.</p>
<p>The following are the first two fundamental questions you keep in mind.</p>
<ul>
<li>What type of variation occurs within my variables?</li>
<li>What type of covariation occurs between my variables?</li>
</ul>
</div>
</div>
<div id="your-work" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Your Work<a class="anchor" aria-label="anchor" href="#your-work"><i class="fas fa-link"></i></a>
</h2>
<p>Here is a list of data your classmates used for Assignment Four.</p>
<div id="world-inequality-report-2022---wir" class="section level3" number="12.3.1">
<h3>
<span class="header-section-number">12.3.1</span> World Inequality Report 2022 - WIR<a class="anchor" aria-label="anchor" href="#world-inequality-report-2022---wir"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>WIR2022TablesFigures-Summary.xlsx: Data of Exective Summary</li>
<li>WIR2022TablesFigures-Chapter6.xlsx:
Historical and current emissions, Income and Population by world region</li>
</ul>
</div>
<div id="world-development-indicators---wdi" class="section level3" number="12.3.2">
<h3>
<span class="header-section-number">12.3.2</span> World Development Indicators - WDI<a class="anchor" aria-label="anchor" href="#world-development-indicators---wdi"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>SP.DYN.TFRT.IN: Fertility rate, total (births per woman)</li>
<li>SP.POP.GROW: Population growth (annual %)</li>
<li>NY.GDP.MKTP.CD: GDP (current US$)</li>
<li>NY.GDP.MKTP.KD.ZG: GDP growth (annual %)</li>
<li>BX.KLT.DINV.CD.WD: Foreign Direct Investment (FDI) inflows</li>
<li>BX.KLT.DINV.CD.WD: Foreign direct investment, net inflows (BoP, current US$)</li>
<li>BN.CAB.XOKA.CD: Current account balance (BoP, current US$)</li>
<li>NE.EXP.GNFS.KD: Exports of goods and services (constant 2015 US$)</li>
<li>NE.IMP.GNFS.KD: Imports of goods and services (constant 2015 US$)</li>
<li>BX.TRF.PWKR.CD.DT: Personal remittances, received (current US$)</li>
<li>NY.GNS.ICTR.ZS: Gross savings (% of GDP)</li>
<li>EN.ATM.CO2E.KT: CO2 emissions (kt)</li>
<li>SE.XPD.TOTL.GB.ZS: Government expenditure on education, total (% of government expenditure)</li>
<li>SE.ENR.PRSC.FM.ZS: School enrollment, primary and secondary (gross), gender parity index (GPI)</li>
<li>SE.PRM.UNER.FE: Children out of school, primary, female</li>
<li>SE.PRM.UNER.MA: Children out of school, primary, male</li>
</ul>
</div>
<div id="united-nations---undata" class="section level3" number="12.3.3">
<h3>
<span class="header-section-number">12.3.3</span> United Nations - UNdata<a class="anchor" aria-label="anchor" href="#united-nations---undata"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Education: “<a href="https://data.un.org/_Docs/SYB/CSV/SYB65_309_202209_Education.csv" class="uri">https://data.un.org/_Docs/SYB/CSV/SYB65_309_202209_Education.csv</a>”</li>
<li>Population: “<a href="https://data.un.org/_Docs/SYB/CSV/SYB65_246_202209_Population%20Growth,%20Fertility%20and%20Mortality%20Indicators.csv" class="uri">https://data.un.org/_Docs/SYB/CSV/SYB65_246_202209_Population%20Growth,%20Fertility%20and%20Mortality%20Indicators.csv</a>”</li>
</ul>
</div>
</div>
<div id="responses-to-questions-2" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Responses to Questions<a class="anchor" aria-label="anchor" href="#responses-to-questions-2"><i class="fas fa-link"></i></a>
</h2>
<div id="q.-wir2022-f8-with-a-fixed-year-say-2020-describing-the-difference-of-goevernment-and-private-income." class="section level3" number="12.4.1">
<h3>
<span class="header-section-number">12.4.1</span> Q. WIR2022, F8 with a fixed year, say 2020 describing the difference of goevernment and private income.<a class="anchor" aria-label="anchor" href="#q.-wir2022-f8-with-a-fixed-year-say-2020-describing-the-difference-of-goevernment-and-private-income."><i class="fas fa-link"></i></a>
</h3>
<p>As for WIR2022, please refer to: <a href="https://ds-sl.github.io/data-analysis/wir2022.nb.html" class="uri">https://ds-sl.github.io/data-analysis/wir2022.nb.html</a></p>
<p>I added explanations to each chart.</p>
<ul>
<li>Step 1. Import the data</li>
</ul>
<p>There is a step-by-step explanation of how to recreate a chart.</p>
<div class="sourceCode" id="cb350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"./data/WIR2022s.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"data-F8"</span><span class="op">)</span></span>
<span><span class="va">df_f8</span></span>
<span><span class="co">#&gt; # A tibble: 51 × 17</span></span>
<span><span class="co">#&gt;     year Germany German…¹ Spain Spain…² France Franc…³    UK</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  1970   1.11      2.30 0.604    4.06  0.422    3.12 0.601</span></span>
<span><span class="co">#&gt;  2  1971   1.12      2.25 0.657    4.53  0.443    3.06 0.689</span></span>
<span><span class="co">#&gt;  3  1972   1.11      2.27 0.624    4.36  0.467    3.08 0.790</span></span>
<span><span class="co">#&gt;  4  1973   1.11      2.23 0.596    4.46  0.478    3.06 0.929</span></span>
<span><span class="co">#&gt;  5  1974   1.13      2.25 0.586    4.64  0.498    3.03 1.09 </span></span>
<span><span class="co">#&gt;  6  1975   1.12      2.35 0.602    4.83  0.545    3.12 1.00 </span></span>
<span><span class="co">#&gt;  7  1976   1.03      2.34 0.581    4.46  0.561    3.08 0.918</span></span>
<span><span class="co">#&gt;  8  1977   1.01      2.42 0.586    4.10  0.567    3.10 0.867</span></span>
<span><span class="co">#&gt;  9  1978   0.990     2.52 0.604    4.10  0.580    3.20 0.881</span></span>
<span><span class="co">#&gt; 10  1979   0.989     2.55 0.621    4.20  0.624    3.30 0.955</span></span>
<span><span class="co">#&gt; # … with 41 more rows, 9 more variables:</span></span>
<span><span class="co">#&gt; #   `UK (private)` &lt;dbl&gt;, Japan &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Japan (private)` &lt;dbl&gt;, Norway &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Norway (private)` &lt;dbl&gt;, USA &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `USA (private)` &lt;dbl&gt;, gwealAVGRICH &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   pwealAVGRICH &lt;dbl&gt;, and abbreviated variable names</span></span>
<span><span class="co">#&gt; #   ¹​`Germany (private)`, ²​`Spain (private)`, …</span></span></code></pre></div>
<ul>
<li>Step 2. Tidy up the data by <code>pivot_longer</code>.</li>
</ul>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f8_rev</span> <span class="op">&lt;-</span> <span class="va">df_f8</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="st">"2020"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">year</span>, Germany_public <span class="op">=</span> <span class="va">Germany</span>, Germany_private <span class="op">=</span> <span class="st">'Germany (private)'</span>, </span>
<span>         Spain_public <span class="op">=</span> <span class="va">Spain</span>, Spain_private <span class="op">=</span> <span class="st">'Spain (private)'</span>, </span>
<span>         France_public <span class="op">=</span> <span class="va">France</span>, France_private <span class="op">=</span> <span class="st">'France (private)'</span>, </span>
<span>         UK_public  <span class="op">=</span> <span class="va">UK</span>, UK_private <span class="op">=</span> <span class="st">'UK (private)'</span>, </span>
<span>         Japan_public <span class="op">=</span> <span class="va">Japan</span>, Japan_private <span class="op">=</span> <span class="st">'Japan (private)'</span>, </span>
<span>         Norway_public <span class="op">=</span> <span class="va">Norway</span>, Norway_private <span class="op">=</span> <span class="st">'Norway (private)'</span>,</span>
<span>         USA_public <span class="op">=</span> <span class="va">USA</span>, USA_private <span class="op">=</span> <span class="st">'USA (private)'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">year</span>, names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"country"</span>,<span class="st">".value"</span><span class="op">)</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, names_to <span class="op">=</span> <span class="st">"type"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span><span class="va">df_f8_rev</span></span>
<span><span class="co">#&gt; # A tibble: 14 × 4</span></span>
<span><span class="co">#&gt;     year country type     value</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  2020 Germany public   0.180</span></span>
<span><span class="co">#&gt;  2  2020 Germany private  5.02 </span></span>
<span><span class="co">#&gt;  3  2020 Spain   public  -0.161</span></span>
<span><span class="co">#&gt;  4  2020 Spain   private  7.03 </span></span>
<span><span class="co">#&gt;  5  2020 France  public  -0.128</span></span>
<span><span class="co">#&gt;  6  2020 France  private  6.33 </span></span>
<span><span class="co">#&gt;  7  2020 UK      public  -1.06 </span></span>
<span><span class="co">#&gt;  8  2020 UK      private  6.82 </span></span>
<span><span class="co">#&gt;  9  2020 Japan   public  -0.338</span></span>
<span><span class="co">#&gt; 10  2020 Japan   private  6.68 </span></span>
<span><span class="co">#&gt; 11  2020 Norway  public   4.98 </span></span>
<span><span class="co">#&gt; 12  2020 Norway  private  0.328</span></span>
<span><span class="co">#&gt; 13  2020 USA     public  -0.603</span></span>
<span><span class="co">#&gt; 14  2020 USA     private  5.92</span></span></code></pre></div>
<ul>
<li>Step 3. Visualize using <code>ggplot2</code>.</li>
</ul>
<p>Then, in this case, <code>geom_col</code> seems to fit.</p>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f8_rev</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">country</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Private versus public wealth in rich countries in 2020"</span>, </span>
<span>       x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"wealth as % of national income"</span>, color <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<p>Can you find a similar data of other countries of this type?</p>
<p>It is in Chapter 3 of the report:</p>
<p><a href="https://wir2022.wid.world/chapter-3/" class="uri">https://wir2022.wid.world/chapter-3/</a></p>
<p>From methodology, I explained on January 25, you can download the data for chapter three: WIR2022TablesFigures-Chapter3.xlsx</p>
</div>
<div id="q.-the-line-graph-looked-strange-at-first-and-i-couldnt-really-see-the-results-clearly.-however-i-could-solve-that-problem-by-using-smoothstat-and-then-the-results-looked-way-better-and-i-was-able-to-interpret-them-easily." class="section level3" number="12.4.2">
<h3>
<span class="header-section-number">12.4.2</span> Q. The line graph looked strange at first and I couldn’t really see the results clearly. However, I could solve that problem by using “smoothstat” and then the results looked way better and I was able to interpret them easily.<a class="anchor" aria-label="anchor" href="#q.-the-line-graph-looked-strange-at-first-and-i-couldnt-really-see-the-results-clearly.-however-i-could-solve-that-problem-by-using-smoothstat-and-then-the-results-looked-way-better-and-i-was-able-to-interpret-them-easily."><i class="fas fa-link"></i></a>
</h3>
<p>The strange looking line graph is called a sawtooth shape, and happens very often. So let me explain it</p>
<ul>
<li><p>WDI indicator: BX.KLT.DINV.CD.WD: Foreign Direct Investment (FDI) inflows</p></li>
<li><p>Step 1. Import the data.</p></li>
</ul>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://vincentarelbundock.github.io/WDI/reference/WDI.html">WDI</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"all"</span>, indicator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>fdi <span class="op">=</span> <span class="st">"BX.KLT.DINV.CD.WD"</span><span class="op">)</span>, start <span class="op">=</span><span class="fl">1970</span> , extra <span class="op">=</span> <span class="cn">TRUE</span>, cache <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">df_fdi</span></span></code></pre></div>
<pre><code>#&gt; Rows: 13832 Columns: 13
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr  (7): country, iso2c, iso3c, region, capital, income...
#&gt; dbl  (4): year, fdi, longitude, latitude
#&gt; lgl  (1): status
#&gt; date (1): lastupdated
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<ul>
<li>Step 2. Check the list of <code>income</code> names.</li>
</ul>
<p>The following code in <code>Base R</code> does the same as the following using <code>tidyverse</code>:
<code>df_fdi %&gt;% distinct(income) %&gt;% pull()</code>.
If the list is long, it may be better to check using <code>tibble</code> by `<code>df_fdi %&gt;% distinct(income)</code>. You can also use <code>DT::datatable(df_fdi)</code> and search items of interest, though it takes up a lot of memory.</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df_fdi</span><span class="op">$</span><span class="va">income</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Low income"          "Aggregates"         </span></span>
<span><span class="co">#&gt; [3] "Upper middle income" "Lower middle income"</span></span>
<span><span class="co">#&gt; [5] "High income"         NA                   </span></span>
<span><span class="co">#&gt; [7] "Not classified"</span></span></code></pre></div>
<ul>
<li>Step 3. Try a line graph.</li>
</ul>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">fdi</span>, color<span class="op">=</span><span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 7 rows containing missing values</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
<p>We observe several problems. But the most significant issue is it looks like a sawtooth. It is because there are so many <code>y</code> values at the same <code>x</code> value. When you draw a line graph, you need to choose only several countries or use group_by and summarize and use summarized data. However, there is an option; we can use a model to summarize the data of each group using <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>. Since you do not want a line but a curve, we use “loess” with <code>span</code>, we used to draw some of WIR2022 charts.</p>
<ul>
<li>Step 4. Let us try <code>group_by</code> and <code>summarize</code>.</li>
</ul>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">fdi</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>,<span class="st">"Not classified"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>fdi_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fdi</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>,y<span class="op">=</span><span class="va">fdi_mean</span>,color<span class="op">=</span><span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'income'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<p>If you do not want the message ‘<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> has grouped output by ’income’. You can override using the <code>.groups</code> argument.’ try the following by adding <code>.group = drop</code>.</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">fdi</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>,<span class="st">"Not classified"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>fdi_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fdi</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>,y<span class="op">=</span><span class="va">fdi_mean</span>,color<span class="op">=</span><span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
<ul>
<li>Step 5. Let us try <code>geom_smooth</code> with <code>loess</code> and <code>span</code>.</li>
</ul>
<p>Do you see similarities and differences? We need to choose the one from the other by our objective, and explain</p>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">fdi</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>,<span class="st">"Not classified"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>,y<span class="op">=</span><span class="va">fdi</span>,color<span class="op">=</span><span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, span <span class="op">=</span> <span class="fl">0.25</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<ul>
<li>Step 6. Change of the scale.</li>
</ul>
<p>It may be a good choice to use <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10()</a></code>. However, since log10 is not finite if the value is not positive, you need to choose those with the indicator positive. Let us see how many zero values are in each income level.</p>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Aggregates"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">fdi</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">income</span>, fill <span class="op">=</span> <span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of countries with FDI is not positive"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-17-1.png" width="672"></div>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">fdi</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>,<span class="st">"Not classified"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>,y<span class="op">=</span><span class="va">fdi</span>,color<span class="op">=</span><span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, span <span class="op">=</span> <span class="fl">0.25</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"The Value FID &lt; 0 or Zero Excluded"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
<p><strong>Note.</strong> If this is the target chart, it may be better to check the number of NA values, 0 values, negative values, and nonzero values in each income group. I add <code>mutate(value = factor(value, levels = c("Positive", "Zero", "Negative", "NA"), labels = c("Positive", "Zero", "Negative", "NA")))</code> in order to set the order of the labels. Please try the same without the line.</p>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, <span class="va">fdi</span>, <span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="cn">NA</span> <span class="op">~</span> <span class="st">"NA"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Zero"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&lt;</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Negative"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Positive"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">value</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-19-1.png" width="672"></div>
</div>
<div id="q.-how-is-it-possible-to-organize-better-the-name-of-the-value-in-the-x-axis-so-that-they-are-better-readable" class="section level3" number="12.4.3">
<h3>
<span class="header-section-number">12.4.3</span> Q. How is it possible to organize better the name of the value in the x axis so that they are better readable?<a class="anchor" aria-label="anchor" href="#q.-how-is-it-possible-to-organize-better-the-name-of-the-value-in-the-x-axis-so-that-they-are-better-readable"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>In the example above, the labels are overlapping. One way is to give an angle to the text with <code>vjust</code> and <code>hjust</code> values to place the labels in appropriate places: <code>theme(axis.text.x = element_text(angle = 30, vjust = 1, hjust=1))</code>
</li>
</ul>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, <span class="va">fdi</span>, <span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="cn">NA</span> <span class="op">~</span> <span class="st">"NA"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Zero"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&lt;</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Negative"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Positive"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">value</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<ul>
<li>You can use another package <code>stringr</code> included in <code>tidyverse</code> but not loaded. <code>scale_x_discrete(labels = function(x) stringr::str_wrap(x, width = 15))</code>
Change the width value to fit to your chart. If you add library(stringr), then <code>scale_x_discrete(labels = function(x) str_wrap(x, width = 15))</code> is enough.</li>
</ul>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, <span class="va">fdi</span>, <span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="cn">NA</span> <span class="op">~</span> <span class="st">"NA"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Zero"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&lt;</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Negative"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Positive"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">value</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-21-1.png" width="672"></div>
<ul>
<li>If you have a long name for the title, use <code>\n</code> for the line feed.</li>
</ul>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_fdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, <span class="va">fdi</span>, <span class="va">income</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">income</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aggregates"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="cn">NA</span> <span class="op">~</span> <span class="st">"NA"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">==</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Zero"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&lt;</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"Negative"</span>,</span>
<span>    <span class="va">fdi</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Positive"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">value</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Zero"</span>, <span class="st">"Negative"</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"long long long long long long long \nlong long long title"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
</div>
<div id="q.-position-of-the-labels" class="section level3" number="12.4.4">
<h3>
<span class="header-section-number">12.4.4</span> Q. Position of the labels<a class="anchor" aria-label="anchor" href="#q.-position-of-the-labels"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>Step 1. If you want to use you own color palette, choose the codes or the color names from the following sites.</p>
<ul>
<li>Color Names: <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/" class="uri">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/</a>
</li>
<li>RGB codes: <a href="https://www.rapidtables.com/web/color/RGB_Color.html" class="uri">https://www.rapidtables.com/web/color/RGB_Color.html</a>
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">color_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AE9D"</span>,<span class="st">"#F58220"</span>,<span class="st">"#6C676E"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Import the data and tidy up</li>
</ul>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"./data/WIR2022s.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"data-F1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `` -&gt; `...1`</span></span>
<span><span class="va">df_f1_rev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">df_f1</span>, <span class="op">-</span><span class="fl">1</span>, names_to <span class="op">=</span> <span class="st">"group"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span><span class="va">df_f1_rev</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span><span class="co">#&gt;   ...1   group       value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Income Bottom 50% 0.084 </span></span>
<span><span class="co">#&gt; 2 Income Middle 40% 0.394 </span></span>
<span><span class="co">#&gt; 3 Income Top 10%    0.522 </span></span>
<span><span class="co">#&gt; 4 Income Top 1%     0.192 </span></span>
<span><span class="co">#&gt; 5 Wealth Bottom 50% 0.0199</span></span>
<span><span class="co">#&gt; 6 Wealth Middle 40% 0.224 </span></span>
<span><span class="co">#&gt; 7 Wealth Top 10%    0.756 </span></span>
<span><span class="co">#&gt; 8 Wealth Top 1%     0.378</span></span></code></pre></div>
<ul>
<li>Step 3. Visualize the data using <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>, change the default fill color using the list of the color in Step 1, and change the scale of the y axis into percents.</li>
</ul>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f1_rev</span><span class="op">[</span><span class="va">df_f1_rev</span><span class="op">$</span><span class="va">group</span> <span class="op">!=</span> <span class="st">"Top 1%"</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...1</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">color_list</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-25-1.png" width="672"></div>
<ul>
<li>Step 4. Add the values in the text. Do not forget that the values should be in percentages.</li>
</ul>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f1_rev</span><span class="op">[</span><span class="va">df_f1_rev</span><span class="op">$</span><span class="va">group</span> <span class="op">!=</span> <span class="st">"Top 1%"</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...1</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">color_list</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...1</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">group</span>, </span>
<span>            label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">label_percent</a></span><span class="op">(</span>accuracy<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
<p><img src="12-a4resp_files/figure-html/unnamed-chunk-26-1.png" width="672">
* Step 5. If you want to change the locations of texts use <code>vjust = -0.2</code>.</p>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f1_rev</span><span class="op">[</span><span class="va">df_f1_rev</span><span class="op">$</span><span class="va">group</span> <span class="op">!=</span> <span class="st">"Top 1%"</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...1</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">color_list</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...1</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">group</span>, </span>
<span>            label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">label_percent</a></span><span class="op">(</span>accuracy<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-27-1.png" width="672"></div>
<ul>
<li>One student used another method to add <code>0.03</code> to the value of <code>y</code> by <code>y = value+0.03</code>. Great!</li>
</ul>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_f1_rev</span><span class="op">[</span><span class="va">df_f1_rev</span><span class="op">$</span><span class="va">group</span> <span class="op">!=</span> <span class="st">"Top 1%"</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...1</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">color_list</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...1</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">+</span><span class="fl">0.03</span>, group <span class="op">=</span> <span class="va">group</span>, </span>
<span>            label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">label_percent</a></span><span class="op">(</span>accuracy<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
<div class="inline-figure">
<img src="12-a4resp_files/figure-html/unnamed-chunk-28-1.png" width="672">
## My Comments after Review</div>
</div>
<div id="visualization-by-charts" class="section level3" number="12.4.5">
<h3>
<span class="header-section-number">12.4.5</span> Visualization by Charts<a class="anchor" aria-label="anchor" href="#visualization-by-charts"><i class="fas fa-link"></i></a>
</h3>
<p>Please try as various charts as possible. You can learn only by experience or from others.</p>
<div id="treat-year-as-a-group" class="section level4" number="12.4.5.1">
<h4>
<span class="header-section-number">12.4.5.1</span> Treat <code>year</code> as a group?<a class="anchor" aria-label="anchor" href="#treat-year-as-a-group"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_wdi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://vincentarelbundock.github.io/WDI/reference/WDI.html">WDI</a></span><span class="op">(</span></span>
<span>  country <span class="op">=</span> <span class="st">"all"</span>, </span>
<span>  indicator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>lifeExp <span class="op">=</span> <span class="st">"SP.DYN.LE00.IN"</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">1990</span>, extra <span class="op">=</span> <span class="cn">TRUE</span>, cache <span class="op">=</span>  <span class="va">wdi_cache</span><span class="op">)</span></span>
<span><span class="va">df_wdi</span></span></code></pre></div>
<pre><code>#&gt; Rows: 16492 Columns: 7
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr (3): country, iso2c, iso3c
#&gt; dbl (4): year, lifeExp, pop, gdpPercap
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<ul>
<li>Something is wrong in the next chart. Can you tell what the problem is?</li>
</ul>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_wdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1988"</span>, <span class="st">"1998"</span>, <span class="st">"2008"</span>, <span class="st">"2018"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Afghanistan"</span>, <span class="st">"Israel"</span>, <span class="st">"Azerbaijan"</span>, <span class="st">"Austria"</span>, <span class="st">"Australia"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">lifeExp</span>, fill<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-31-1.png" width="672"></div>
<p>I erased the second line: <code>filter(year %in% c("1988", "1998", "2008", "2018"))</code> but the result is very similar.</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_wdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Afghanistan"</span>, <span class="st">"Israel"</span>, <span class="st">"Azerbaijan"</span>, <span class="st">"Austria"</span>, <span class="st">"Australia"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">lifeExp</span>, fill<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 9 rows containing non-finite values</span></span>
<span><span class="co">#&gt; (`stat_boxplot()`).</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-32-1.png" width="672"></div>
<p>If you look at the table, you can see that year is a integer vector, not a character vector. Then what happens if we remove quotation marks. The next chart is not a box plot anymore. It is because, for each year there is only one value for each country.</p>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_wdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1988</span>, <span class="fl">1998</span>, <span class="fl">2008</span>, <span class="fl">2018</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Afghanistan"</span>, <span class="st">"Israel"</span>, <span class="st">"Azerbaijan"</span>, <span class="st">"Austria"</span>, <span class="st">"Australia"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">lifeExp</span>, fill<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-33-1.png" width="672"></div>
<p>If we want to take <code>year</code> as a group after selecting some years, then we should try the next using <code>factor(year)</code>. You can change the label of x axis by
<code>labs(x = "year")</code> easily. We should also notice that there are no values for 1988. We should check basic information as such first.</p>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_wdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1988</span>, <span class="fl">1998</span>, <span class="fl">2008</span>, <span class="fl">2018</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Afghanistan"</span>, <span class="st">"Israel"</span>, <span class="st">"Azerbaijan"</span>, <span class="st">"Austria"</span>, <span class="st">"Australia"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, y<span class="op">=</span><span class="va">lifeExp</span>, fill<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12-a4resp_files/figure-html/unnamed-chunk-34-1.png" width="672">
It is possible if you change year to a character vector by <code>mutate(year = as.character(year))</code>.</p>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_wdi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1998"</span>, <span class="st">"2008"</span>, <span class="st">"2018"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Afghanistan"</span>, <span class="st">"Israel"</span>, <span class="st">"Azerbaijan"</span>, <span class="st">"Austria"</span>, <span class="st">"Australia"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="va">lifeExp</span>, fill<span class="op">=</span><span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-35-1.png" width="672"></div>
</div>
</div>
<div id="un-data" class="section level3" number="12.4.6">
<h3>
<span class="header-section-number">12.4.6</span> UN Data<a class="anchor" aria-label="anchor" href="#un-data"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>UNdata: <a href="https://data.un.org" class="uri">https://data.un.org</a>
</li>
</ul>
<p>Data of World Development Indicators are in a uniform format and downloadable using an R package WDI. So it is easy to handle. However, other data require data transformation to make it tidy. We give a couple of examples. Most of the UN data, they are in CSV, and you can get a link quickly, or download it by clicking. Though the data structure is not uniform, it is relatively easy to handle.</p>
<div id="education" class="section level4" number="12.4.6.1">
<h4>
<span class="header-section-number">12.4.6.1</span> Education<a class="anchor" aria-label="anchor" href="#education"><i class="fas fa-link"></i></a>
</h4>
<p>By the following, you can see that the first row is not the column name. R gives column names such as …1, …2, etc., when the column name is void.</p>
<p>You can copy the link (url) by right click or ctrl+click.</p>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url_un_edu</span> <span class="op">&lt;-</span> <span class="st">"https://data.un.org/_Docs/SYB/CSV/SYB65_309_202209_Education.csv"</span></span></code></pre></div>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">url_un_edu</span><span class="op">)</span></span>
<span><span class="va">un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Let is skip the first row by adding <code>skip = 1</code>.</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">url_un_edu</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; Rows: 7282 Columns: 7
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr (4): ...2, Series, Footnotes, Source
#&gt; dbl (3): Region/Country/Area, Year, Value
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
#&gt; # A tibble: 10 × 7
#&gt;    `Region/Country/Area` ...2   Year Series  Value Footnotes
#&gt;                    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    
#&gt;  1                     1 Tota…  2005 Stude… 6.79e5 &lt;NA&gt;     
#&gt;  2                     1 Tota…  2005 Gross… 1.05e2 &lt;NA&gt;     
#&gt;  3                     1 Tota…  2005 Gross… 9.97e1 &lt;NA&gt;     
#&gt;  4                     1 Tota…  2005 Stude… 5.09e5 &lt;NA&gt;     
#&gt;  5                     1 Tota…  2005 Gross… 6.58e1 &lt;NA&gt;     
#&gt;  6                     1 Tota…  2005 Gross… 6.23e1 &lt;NA&gt;     
#&gt;  7                     1 Tota…  2005 Stude… 2.00e5 &lt;NA&gt;     
#&gt;  8                     1 Tota…  2005 Gross… 5.12e1 &lt;NA&gt;     
#&gt;  9                     1 Tota…  2005 Gross… 4.83e1 &lt;NA&gt;     
#&gt; 10                     1 Tota…  2010 Stude… 6.97e5 &lt;NA&gt;     
#&gt; # ℹ 1 more variable: Source &lt;chr&gt;</code></pre>
<p>It is a very large data, and we need to check the values.</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">un_edu</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Region/Country/Area     ...2                Year     </span></span>
<span><span class="co">#&gt;  Min.   :  1.0       Length:7282        Min.   :2000  </span></span>
<span><span class="co">#&gt;  1st Qu.:178.0       Class :character   1st Qu.:2005  </span></span>
<span><span class="co">#&gt;  Median :417.0       Mode  :character   Median :2010  </span></span>
<span><span class="co">#&gt;  Mean   :408.8                          Mean   :2012  </span></span>
<span><span class="co">#&gt;  3rd Qu.:626.0                          3rd Qu.:2015  </span></span>
<span><span class="co">#&gt;  Max.   :894.0                          Max.   :2021  </span></span>
<span><span class="co">#&gt;     Series              Value           Footnotes        </span></span>
<span><span class="co">#&gt;  Length:7282        Min.   :     0.0   Length:7282       </span></span>
<span><span class="co">#&gt;  Class :character   1st Qu.:    71.6   Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character   Median :   100.2   Mode  :character  </span></span>
<span><span class="co">#&gt;                     Mean   :  2534.7                     </span></span>
<span><span class="co">#&gt;                     3rd Qu.:   133.6                     </span></span>
<span><span class="co">#&gt;                     Max.   :750125.0                     </span></span>
<span><span class="co">#&gt;     Source         </span></span>
<span><span class="co">#&gt;  Length:7282       </span></span>
<span><span class="co">#&gt;  Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character  </span></span>
<span><span class="co">#&gt;                    </span></span>
<span><span class="co">#&gt;                    </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>We can see that the Year is from 2000 to 2021. The first variable, Region/Country/Area and the fifth variable, Value are <code>dbl</code>, i.e., double; hence, these are numerical variables, and you can see them from the summary as well. But it is not easy to see other variables. Let us try them one by one.</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">...2</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 224 × 1</span></span>
<span><span class="co">#&gt;    ...2                         </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                        </span></span>
<span><span class="co">#&gt;  1 Total, all countries or areas</span></span>
<span><span class="co">#&gt;  2 Northern Africa              </span></span>
<span><span class="co">#&gt;  3 Sub-Saharan Africa           </span></span>
<span><span class="co">#&gt;  4 Northern America             </span></span>
<span><span class="co">#&gt;  5 Latin America &amp; the Caribbean</span></span>
<span><span class="co">#&gt;  6 Central Asia                 </span></span>
<span><span class="co">#&gt;  7 Eastern Asia                 </span></span>
<span><span class="co">#&gt;  8 South-eastern Asia           </span></span>
<span><span class="co">#&gt;  9 Southern Asia                </span></span>
<span><span class="co">#&gt; 10 Western Asia                 </span></span>
<span><span class="co">#&gt; # ℹ 214 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Series</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 × 1</span></span>
<span><span class="co">#&gt;   Series                                                    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                     </span></span>
<span><span class="co">#&gt; 1 Students enrolled in primary education (thousands)        </span></span>
<span><span class="co">#&gt; 2 Gross enrollment ratio - Primary (male)                   </span></span>
<span><span class="co">#&gt; 3 Gross enrollment ratio - Primary (female)                 </span></span>
<span><span class="co">#&gt; 4 Students enrolled in secondary education (thousands)      </span></span>
<span><span class="co">#&gt; 5 Gross enrollment ratio - Secondary (male)                 </span></span>
<span><span class="co">#&gt; 6 Gross enrollment ratio - Secondary (female)               </span></span>
<span><span class="co">#&gt; 7 Students enrolled in upper secondary education (thousands)</span></span>
<span><span class="co">#&gt; 8 Gross enrollment ratio - Upper secondary level (male)     </span></span>
<span><span class="co">#&gt; 9 Gross enrollment ratio - Upper secondary level (female)</span></span></code></pre></div>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Footnotes</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 1</span></span>
<span><span class="co">#&gt;   Footnotes</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    </span></span>
<span><span class="co">#&gt; 1 &lt;NA&gt;     </span></span>
<span><span class="co">#&gt; 2 Estimate.</span></span></code></pre></div>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Source</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   Source                                                    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                     </span></span>
<span><span class="co">#&gt; 1 United Nations Educational, Scientific and Cultural Organ…</span></span></code></pre></div>
<ul>
<li>We may need to handle Footnotes carefully later, but for the first exploration, we need, …2 for Region, Year, Series, Values.</li>
</ul>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_edu</span> <span class="op">&lt;-</span> <span class="va">un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>Region <span class="op">=</span> <span class="va">...2</span>, <span class="va">Year</span>, <span class="va">Series</span>, <span class="va">Value</span><span class="op">)</span></span>
<span><span class="va">df_un_edu</span></span>
<span><span class="co">#&gt; # A tibble: 7,282 × 4</span></span>
<span><span class="co">#&gt;    Region                         Year Series          Value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                         &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Total, all countries or areas  2005 Students enro… 6.79e5</span></span>
<span><span class="co">#&gt;  2 Total, all countries or areas  2005 Gross enrollm… 1.05e2</span></span>
<span><span class="co">#&gt;  3 Total, all countries or areas  2005 Gross enrollm… 9.97e1</span></span>
<span><span class="co">#&gt;  4 Total, all countries or areas  2005 Students enro… 5.09e5</span></span>
<span><span class="co">#&gt;  5 Total, all countries or areas  2005 Gross enrollm… 6.58e1</span></span>
<span><span class="co">#&gt;  6 Total, all countries or areas  2005 Gross enrollm… 6.23e1</span></span>
<span><span class="co">#&gt;  7 Total, all countries or areas  2005 Students enro… 2.00e5</span></span>
<span><span class="co">#&gt;  8 Total, all countries or areas  2005 Gross enrollm… 5.12e1</span></span>
<span><span class="co">#&gt;  9 Total, all countries or areas  2005 Gross enrollm… 4.83e1</span></span>
<span><span class="co">#&gt; 10 Total, all countries or areas  2010 Students enro… 6.97e5</span></span>
<span><span class="co">#&gt; # ℹ 7,272 more rows</span></span></code></pre></div>
<p>Is there a way to separate regions from countries?</p>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">wdi_cache</span><span class="op">$</span><span class="va">country</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Region"</span><span class="op">=</span><span class="st">"country"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">iso2c</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Region</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 176 × 1</span></span>
<span><span class="co">#&gt;    Region             </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              </span></span>
<span><span class="co">#&gt;  1 Afghanistan        </span></span>
<span><span class="co">#&gt;  2 Albania            </span></span>
<span><span class="co">#&gt;  3 Algeria            </span></span>
<span><span class="co">#&gt;  4 Andorra            </span></span>
<span><span class="co">#&gt;  5 Angola             </span></span>
<span><span class="co">#&gt;  6 Antigua and Barbuda</span></span>
<span><span class="co">#&gt;  7 Argentina          </span></span>
<span><span class="co">#&gt;  8 Armenia            </span></span>
<span><span class="co">#&gt;  9 Aruba              </span></span>
<span><span class="co">#&gt; 10 Australia          </span></span>
<span><span class="co">#&gt; # ℹ 166 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">wdi_cache</span><span class="op">$</span><span class="va">country</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Region"</span><span class="op">=</span><span class="st">"country"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">iso2c</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Region</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 48 × 1</span></span>
<span><span class="co">#&gt;    Region                       </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                        </span></span>
<span><span class="co">#&gt;  1 Total, all countries or areas</span></span>
<span><span class="co">#&gt;  2 Northern Africa              </span></span>
<span><span class="co">#&gt;  3 Sub-Saharan Africa           </span></span>
<span><span class="co">#&gt;  4 Northern America             </span></span>
<span><span class="co">#&gt;  5 Latin America &amp; the Caribbean</span></span>
<span><span class="co">#&gt;  6 Central Asia                 </span></span>
<span><span class="co">#&gt;  7 Eastern Asia                 </span></span>
<span><span class="co">#&gt;  8 South-eastern Asia           </span></span>
<span><span class="co">#&gt;  9 Southern Asia                </span></span>
<span><span class="co">#&gt; 10 Western Asia                 </span></span>
<span><span class="co">#&gt; # ℹ 38 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">wdi_cache</span><span class="op">$</span><span class="va">country</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Region"</span><span class="op">=</span><span class="st">"country"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">iso2c</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Total, all countries or areas"</span></span>
<span><span class="co">#&gt;  [2] "Northern Africa"              </span></span>
<span><span class="co">#&gt;  [3] "Sub-Saharan Africa"           </span></span>
<span><span class="co">#&gt;  [4] "Northern America"             </span></span>
<span><span class="co">#&gt;  [5] "Latin America &amp; the Caribbean"</span></span>
<span><span class="co">#&gt;  [6] "Central Asia"                 </span></span>
<span><span class="co">#&gt;  [7] "Eastern Asia"                 </span></span>
<span><span class="co">#&gt;  [8] "South-eastern Asia"           </span></span>
<span><span class="co">#&gt;  [9] "Southern Asia"                </span></span>
<span><span class="co">#&gt; [10] "Western Asia"                 </span></span>
<span><span class="co">#&gt; [11] "Europe"                       </span></span>
<span><span class="co">#&gt; [12] "Oceania"                      </span></span>
<span><span class="co">#&gt; [13] "Anguilla"                     </span></span>
<span><span class="co">#&gt; [14] "Bahamas"                      </span></span>
<span><span class="co">#&gt; [15] "Bolivia (Plurin. State of)"   </span></span>
<span><span class="co">#&gt; [16] "China, Hong Kong SAR"         </span></span>
<span><span class="co">#&gt; [17] "China, Macao SAR"             </span></span>
<span><span class="co">#&gt; [18] "Congo"                        </span></span>
<span><span class="co">#&gt; [19] "Cook Islands"                 </span></span>
<span><span class="co">#&gt; [20] "Côte d’Ivoire"                </span></span>
<span><span class="co">#&gt; [21] "Curaçao"                      </span></span>
<span><span class="co">#&gt; [22] "Dem. People's Rep. Korea"     </span></span>
<span><span class="co">#&gt; [23] "Dem. Rep. of the Congo"       </span></span>
<span><span class="co">#&gt; [24] "Egypt"                        </span></span>
<span><span class="co">#&gt; [25] "Gambia"                       </span></span>
<span><span class="co">#&gt; [26] "Holy See"                     </span></span>
<span><span class="co">#&gt; [27] "Iran (Islamic Republic of)"   </span></span>
<span><span class="co">#&gt; [28] "Kyrgyzstan"                   </span></span>
<span><span class="co">#&gt; [29] "Lao People's Dem. Rep."       </span></span>
<span><span class="co">#&gt; [30] "Micronesia (Fed. States of)"  </span></span>
<span><span class="co">#&gt; [31] "Montserrat"                   </span></span>
<span><span class="co">#&gt; [32] "Netherlands Antilles [former]"</span></span>
<span><span class="co">#&gt; [33] "Niue"                         </span></span>
<span><span class="co">#&gt; [34] "Republic of Korea"            </span></span>
<span><span class="co">#&gt; [35] "Republic of Moldova"          </span></span>
<span><span class="co">#&gt; [36] "Saint Kitts and Nevis"        </span></span>
<span><span class="co">#&gt; [37] "Saint Lucia"                  </span></span>
<span><span class="co">#&gt; [38] "Saint Vincent &amp; Grenadines"   </span></span>
<span><span class="co">#&gt; [39] "Slovakia"                     </span></span>
<span><span class="co">#&gt; [40] "State of Palestine"           </span></span>
<span><span class="co">#&gt; [41] "Sudan [former]"               </span></span>
<span><span class="co">#&gt; [42] "Tokelau"                      </span></span>
<span><span class="co">#&gt; [43] "Türkiye"                      </span></span>
<span><span class="co">#&gt; [44] "United Rep. of Tanzania"      </span></span>
<span><span class="co">#&gt; [45] "United States of America"     </span></span>
<span><span class="co">#&gt; [46] "Venezuela (Boliv. Rep. of)"   </span></span>
<span><span class="co">#&gt; [47] "Viet Nam"                     </span></span>
<span><span class="co">#&gt; [48] "Yemen"</span></span></code></pre></div>
<p>There are some countries iso2c is not properly assigned. From the list above, Probably, the first 12 are areas and the value contains the aggregated value.</p>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area</span> <span class="op">&lt;-</span> <span class="va">df_un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">area</span></span>
<span><span class="co">#&gt;  [1] "Total, all countries or areas"</span></span>
<span><span class="co">#&gt;  [2] "Northern Africa"              </span></span>
<span><span class="co">#&gt;  [3] "Sub-Saharan Africa"           </span></span>
<span><span class="co">#&gt;  [4] "Northern America"             </span></span>
<span><span class="co">#&gt;  [5] "Latin America &amp; the Caribbean"</span></span>
<span><span class="co">#&gt;  [6] "Central Asia"                 </span></span>
<span><span class="co">#&gt;  [7] "Eastern Asia"                 </span></span>
<span><span class="co">#&gt;  [8] "South-eastern Asia"           </span></span>
<span><span class="co">#&gt;  [9] "Southern Asia"                </span></span>
<span><span class="co">#&gt; [10] "Western Asia"                 </span></span>
<span><span class="co">#&gt; [11] "Europe"                       </span></span>
<span><span class="co">#&gt; [12] "Oceania"</span></span></code></pre></div>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu_area</span> <span class="op">&lt;-</span> <span class="va">df_un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">area</span><span class="op">)</span></span>
<span><span class="va">un_edu_region</span> <span class="op">&lt;-</span> <span class="va">df_un_edu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">Region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">area</span><span class="op">)</span></span></code></pre></div>
<p>Now we can start studying the data.</p>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu_area</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Series</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gross enrollment ratio - Upper secondary level (male)"</span>, <span class="st">"Gross enrollment ratio - Upper secondary level (female)"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Value</span>, color <span class="op">=</span> <span class="va">Region</span>, linetype <span class="op">=</span> <span class="va">Series</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-54-1.png" width="672"></div>
<div class="sourceCode" id="cb395"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_edu_area</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Series</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gross enrollment ratio - Upper secondary level (male)"</span>, <span class="st">"Gross enrollment ratio - Upper secondary level (female)"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Series</span>, values_from <span class="op">=</span> <span class="va">Value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span> <span class="op">(</span>Ratio <span class="op">=</span> <span class="va">`Gross enrollment ratio - Upper secondary level (female)`</span><span class="op">/</span><span class="va">`Gross enrollment ratio - Upper secondary level (male)`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Ratio</span>, color <span class="op">=</span> <span class="va">Region</span>, linetype <span class="op">=</span> <span class="va">Region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Upper Secondary Level Education"</span>, subtitle <span class="op">=</span> <span class="st">"Ratio = female/male"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-55-1.png" width="672"></div>
</div>
<div id="population" class="section level4" number="12.4.6.2">
<h4>
<span class="header-section-number">12.4.6.2</span> Population<a class="anchor" aria-label="anchor" href="#population"><i class="fas fa-link"></i></a>
</h4>
<p>Data structure is similar to the previous one. So use <code>skip=1</code>, and check the variable s briefly.</p>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url_un_pop</span> <span class="op">=</span> <span class="st">"https://data.un.org/_Docs/SYB/CSV/SYB65_246_202209_Population%20Growth,%20Fertility%20and%20Mortality%20Indicators.csv"</span></span>
<span><span class="va">df_un_pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">url_un_pop</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">df_un_pop</span></span></code></pre></div>
<pre><code>#&gt; Rows: 6654 Columns: 7
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr (4): X, Series, Footnotes, Source
#&gt; dbl (2): Region.Country.Area, Year
#&gt; num (1): Value
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
#&gt; # A tibble: 10 × 7
#&gt;    Region.Country.Area X         Year Series Value Footnotes
#&gt;                  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;    
#&gt;  1                   1 Total, …  2010 Popul…   1.3 &lt;NA&gt;     
#&gt;  2                   1 Total, …  2010 Total…   2.6 &lt;NA&gt;     
#&gt;  3                   1 Total, …  2010 Infan…  37.1 &lt;NA&gt;     
#&gt;  4                   1 Total, …  2010 Mater… 253   &lt;NA&gt;     
#&gt;  5                   1 Total, …  2010 Life …  70.1 &lt;NA&gt;     
#&gt;  6                   1 Total, …  2010 Life …  67.6 &lt;NA&gt;     
#&gt;  7                   1 Total, …  2010 Life …  72.7 &lt;NA&gt;     
#&gt;  8                   1 Total, …  2015 Popul…   1.2 &lt;NA&gt;     
#&gt;  9                   1 Total, …  2015 Total…   2.5 &lt;NA&gt;     
#&gt; 10                   1 Total, …  2015 Infan…  31.5 &lt;NA&gt;     
#&gt; # ℹ 1 more variable: Source &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Source</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 1</span></span>
<span><span class="co">#&gt;   Source                                                    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                     </span></span>
<span><span class="co">#&gt; 1 "United Nations Population Division, New York, World Popu…</span></span>
<span><span class="co">#&gt; 2 "United Nations Population Division, New York, World Popu…</span></span>
<span><span class="co">#&gt; 3 "United Nations Statistics Division, New York, \"Demograp…</span></span>
<span><span class="co">#&gt; 4 "World Health Organization (WHO), the United Nations Chil…</span></span></code></pre></div>
<div class="sourceCode" id="cb399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Footnotes</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 82 × 1</span></span>
<span><span class="co">#&gt;    Footnotes                                                </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                                                    </span></span>
<span><span class="co">#&gt;  1 &lt;NA&gt;                                                     </span></span>
<span><span class="co">#&gt;  2 Projected estimate (medium fertility variant).           </span></span>
<span><span class="co">#&gt;  3 Including Saint Helena.                                  </span></span>
<span><span class="co">#&gt;  4 Projected estimate (medium fertility variant).;Including…</span></span>
<span><span class="co">#&gt;  5 Including Bermuda, Greenland, and Saint Pierre and Mique…</span></span>
<span><span class="co">#&gt;  6 Projected estimate (medium fertility variant).;Including…</span></span>
<span><span class="co">#&gt;  7 Including Anguilla, Bonaire, Sint Eustatius and Saba, Br…</span></span>
<span><span class="co">#&gt;  8 Projected estimate (medium fertility variant).;Including…</span></span>
<span><span class="co">#&gt;  9 Including Falkland Islands (Malvinas).                   </span></span>
<span><span class="co">#&gt; 10 Projected estimate (medium fertility variant).;Including…</span></span>
<span><span class="co">#&gt; # ℹ 72 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 264 × 1</span></span>
<span><span class="co">#&gt;    X                            </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                        </span></span>
<span><span class="co">#&gt;  1 Total, all countries or areas</span></span>
<span><span class="co">#&gt;  2 Africa                       </span></span>
<span><span class="co">#&gt;  3 Northern Africa              </span></span>
<span><span class="co">#&gt;  4 Sub-Saharan Africa           </span></span>
<span><span class="co">#&gt;  5 Eastern Africa               </span></span>
<span><span class="co">#&gt;  6 Middle Africa                </span></span>
<span><span class="co">#&gt;  7 Southern Africa              </span></span>
<span><span class="co">#&gt;  8 Western Africa               </span></span>
<span><span class="co">#&gt;  9 Northern America             </span></span>
<span><span class="co">#&gt; 10 Latin America &amp; the Caribbean</span></span>
<span><span class="co">#&gt; # ℹ 254 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_un_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Series</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 1</span></span>
<span><span class="co">#&gt;   Series                                                  </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                                                   </span></span>
<span><span class="co">#&gt; 1 Population annual rate of increase (percent)            </span></span>
<span><span class="co">#&gt; 2 Total fertility rate (children per women)               </span></span>
<span><span class="co">#&gt; 3 Infant mortality for both sexes (per 1,000 live births) </span></span>
<span><span class="co">#&gt; 4 Maternal mortality ratio (deaths per 100,000 population)</span></span>
<span><span class="co">#&gt; 5 Life expectancy at birth for both sexes (years)         </span></span>
<span><span class="co">#&gt; 6 Life expectancy at birth for males (years)              </span></span>
<span><span class="co">#&gt; 7 Life expectancy at birth for females (years)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Footnotes need to be studied.</li>
<li>There are four different sources.</li>
<li>X is for the region, the first 30 are areas, and the rest are countries or regions.</li>
<li>There are seven series. It may be easier if we assign shorter names for each value.</li>
</ol>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_area</span> <span class="op">&lt;-</span> <span class="va">df_un_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pop_area</span></span>
<span><span class="co">#&gt;  [1] "Total, all countries or areas"</span></span>
<span><span class="co">#&gt;  [2] "Africa"                       </span></span>
<span><span class="co">#&gt;  [3] "Northern Africa"              </span></span>
<span><span class="co">#&gt;  [4] "Sub-Saharan Africa"           </span></span>
<span><span class="co">#&gt;  [5] "Eastern Africa"               </span></span>
<span><span class="co">#&gt;  [6] "Middle Africa"                </span></span>
<span><span class="co">#&gt;  [7] "Southern Africa"              </span></span>
<span><span class="co">#&gt;  [8] "Western Africa"               </span></span>
<span><span class="co">#&gt;  [9] "Northern America"             </span></span>
<span><span class="co">#&gt; [10] "Latin America &amp; the Caribbean"</span></span>
<span><span class="co">#&gt; [11] "Caribbean"                    </span></span>
<span><span class="co">#&gt; [12] "Central America"              </span></span>
<span><span class="co">#&gt; [13] "South America"                </span></span>
<span><span class="co">#&gt; [14] "Asia"                         </span></span>
<span><span class="co">#&gt; [15] "Central Asia"                 </span></span>
<span><span class="co">#&gt; [16] "Eastern Asia"                 </span></span>
<span><span class="co">#&gt; [17] "South-central Asia"           </span></span>
<span><span class="co">#&gt; [18] "South-eastern Asia"           </span></span>
<span><span class="co">#&gt; [19] "Southern Asia"                </span></span>
<span><span class="co">#&gt; [20] "Western Asia"                 </span></span>
<span><span class="co">#&gt; [21] "Europe"                       </span></span>
<span><span class="co">#&gt; [22] "Eastern Europe"               </span></span>
<span><span class="co">#&gt; [23] "Northern Europe"              </span></span>
<span><span class="co">#&gt; [24] "Southern Europe"              </span></span>
<span><span class="co">#&gt; [25] "Western Europe"               </span></span>
<span><span class="co">#&gt; [26] "Oceania"                      </span></span>
<span><span class="co">#&gt; [27] "Australia and New Zealand"    </span></span>
<span><span class="co">#&gt; [28] "Melanesia"                    </span></span>
<span><span class="co">#&gt; [29] "Micronesia"                   </span></span>
<span><span class="co">#&gt; [30] "Polynesia"</span></span></code></pre></div>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_pop</span> <span class="op">&lt;-</span> <span class="va">df_un_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>Region <span class="op">=</span> <span class="va">X</span>, <span class="va">Year</span>, <span class="va">Series</span>, <span class="va">Value</span><span class="op">)</span></span>
<span><span class="va">un_pop</span></span>
<span><span class="co">#&gt; # A tibble: 6,654 × 4</span></span>
<span><span class="co">#&gt;    Region                         Year Series          Value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                         &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Total, all countries or areas  2010 Population ann…   1.3</span></span>
<span><span class="co">#&gt;  2 Total, all countries or areas  2010 Total fertilit…   2.6</span></span>
<span><span class="co">#&gt;  3 Total, all countries or areas  2010 Infant mortali…  37.1</span></span>
<span><span class="co">#&gt;  4 Total, all countries or areas  2010 Maternal morta… 253  </span></span>
<span><span class="co">#&gt;  5 Total, all countries or areas  2010 Life expectanc…  70.1</span></span>
<span><span class="co">#&gt;  6 Total, all countries or areas  2010 Life expectanc…  67.6</span></span>
<span><span class="co">#&gt;  7 Total, all countries or areas  2010 Life expectanc…  72.7</span></span>
<span><span class="co">#&gt;  8 Total, all countries or areas  2015 Population ann…   1.2</span></span>
<span><span class="co">#&gt;  9 Total, all countries or areas  2015 Total fertilit…   2.5</span></span>
<span><span class="co">#&gt; 10 Total, all countries or areas  2015 Infant mortali…  31.5</span></span>
<span><span class="co">#&gt; # ℹ 6,644 more rows</span></span></code></pre></div>
<p>Let us change the names of series.</p>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_pop_wide</span> <span class="op">&lt;-</span> <span class="va">un_pop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Series</span>, values_from <span class="op">=</span> <span class="va">Value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">un_pop_wide</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Region"</span>, <span class="st">"Year"</span>, <span class="st">"IncRate"</span>, <span class="st">"Fert"</span>, <span class="st">"InfDeath"</span>, <span class="st">"MatDeath"</span>, <span class="st">"LifeExp"</span>, <span class="st">"LifeExpM"</span>, <span class="st">"LifeExpF"</span><span class="op">)</span></span>
<span><span class="va">un_pop_wide</span></span>
<span><span class="co">#&gt; # A tibble: 1,005 × 9</span></span>
<span><span class="co">#&gt;    Region       Year IncRate  Fert InfDeath MatDeath LifeExp</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Total, all…  2010     1.3   2.6     37.1      253    70.1</span></span>
<span><span class="co">#&gt;  2 Total, all…  2015     1.2   2.5     31.5      225    71.8</span></span>
<span><span class="co">#&gt;  3 Total, all…  2017     1.1   2.5     29.6      218    72.3</span></span>
<span><span class="co">#&gt;  4 Total, all…  2022     0.8   2.3     27.5       NA    71.7</span></span>
<span><span class="co">#&gt;  5 Africa       2010     2.6   4.9     60.9       NA    58.6</span></span>
<span><span class="co">#&gt;  6 Africa       2015     2.6   4.6     52.5       NA    61.1</span></span>
<span><span class="co">#&gt;  7 Africa       2022     2.3   4.2     44.2       NA    62.2</span></span>
<span><span class="co">#&gt;  8 Northern A…  2010     1.9   3.2     29.5      148    69.6</span></span>
<span><span class="co">#&gt;  9 Northern A…  2015     2.1   3.4     25.3      120    70.9</span></span>
<span><span class="co">#&gt; 10 Northern A…  2017     2     3.2     24.2      115    71.5</span></span>
<span><span class="co">#&gt; # ℹ 995 more rows</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: LifeExpM &lt;dbl&gt;, LifeExpF &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_pop_long</span> <span class="op">&lt;-</span> <span class="va">un_pop_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Series"</span>, values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span></span>
<span><span class="va">un_pop_long</span>                                           </span>
<span><span class="co">#&gt; # A tibble: 7,035 × 4</span></span>
<span><span class="co">#&gt;    Region                         Year Series   Value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Total, all countries or areas  2010 IncRate    1.3</span></span>
<span><span class="co">#&gt;  2 Total, all countries or areas  2010 Fert       2.6</span></span>
<span><span class="co">#&gt;  3 Total, all countries or areas  2010 InfDeath  37.1</span></span>
<span><span class="co">#&gt;  4 Total, all countries or areas  2010 MatDeath 253  </span></span>
<span><span class="co">#&gt;  5 Total, all countries or areas  2010 LifeExp   70.1</span></span>
<span><span class="co">#&gt;  6 Total, all countries or areas  2010 LifeExpM  67.6</span></span>
<span><span class="co">#&gt;  7 Total, all countries or areas  2010 LifeExpF  72.7</span></span>
<span><span class="co">#&gt;  8 Total, all countries or areas  2015 IncRate    1.2</span></span>
<span><span class="co">#&gt;  9 Total, all countries or areas  2015 Fert       2.5</span></span>
<span><span class="co">#&gt; 10 Total, all countries or areas  2015 InfDeath  31.5</span></span>
<span><span class="co">#&gt; # ℹ 7,025 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">un_pop_long_area</span> <span class="op">&lt;-</span> <span class="va">un_pop_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">pop_area</span><span class="op">)</span></span>
<span><span class="va">un_pop_long_region</span> <span class="op">&lt;-</span> <span class="va">un_pop_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">Region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">pop_area</span><span class="op">)</span></span>
<span><span class="va">un_pop_wide_area</span> <span class="op">&lt;-</span> <span class="va">un_pop_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">pop_area</span><span class="op">)</span></span>
<span><span class="va">un_pop_wide_region</span> <span class="op">&lt;-</span> <span class="va">un_pop_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">Region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">pop_area</span><span class="op">)</span></span></code></pre></div>
<p>Now we can visualize data.</p>
</div>
</div>
</div>
<div id="wir-package" class="section level2" number="12.5">
<h2>
<span class="header-section-number">12.5</span> WIR Package<a class="anchor" aria-label="anchor" href="#wir-package"><i class="fas fa-link"></i></a>
</h2>
<p>In the following, we explain how to download data by an R package <code>wir</code>. First, you need to install the package. However, it is not an official R package yet; you need to use the package <code>devtools</code> to install it.</p>
<div class="sourceCode" id="cb407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"WIDworld/wid-r-tool"</span><span class="op">)</span></span></code></pre></div>
<p>I have not studied fully, but you can download the data by a package called <code>wir</code>. See <a href="https://ds-sl.github.io/data-analysis/wir2022.nb.html">here</a>. After installing the package, check the <a href="https://wid.world/codes-dictionary">codebook</a> of the indicators. The following is not the ratio given in F8, but an example.</p>
<ul>
<li>w wealth-to-income ratio or labor/capital share fraction of national income</li>
<li>wealg: net public wealth to net national income ratio</li>
<li>wealp: net private wealth to net national income ratio</li>
</ul>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">wid</span><span class="op">)</span></span>
<span><span class="va">wwealg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wid/man/download_wid.html">download_wid</a></span><span class="op">(</span>indicators <span class="op">=</span> <span class="st">"wwealg"</span>, areas <span class="op">=</span> <span class="st">"all"</span>, years <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="va">wwealp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wid/man/download_wid.html">download_wid</a></span><span class="op">(</span>indicators <span class="op">=</span> <span class="st">"wwealp"</span>, areas <span class="op">=</span> <span class="st">"all"</span>, years <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<pre><code>#&gt; Rows: 8783 Columns: 5
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr (3): country, variable, percentile
#&gt; dbl (2): year, value
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
#&gt; Rows: 8989 Columns: 5
#&gt; ── Column specification ────────────────────────────────────
#&gt; Delimiter: ","
#&gt; chr (3): country, variable, percentile
#&gt; dbl (2): year, value
#&gt; 
#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.
#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">public</span> <span class="op">&lt;-</span> <span class="va">wwealg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, public <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span><span class="va">public</span></span>
<span><span class="co">#&gt; # A tibble: 8,783 × 3</span></span>
<span><span class="co">#&gt;    country  year public</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 AD       1995 0.0765</span></span>
<span><span class="co">#&gt;  2 AD       1996 0.0973</span></span>
<span><span class="co">#&gt;  3 AD       1997 0.118 </span></span>
<span><span class="co">#&gt;  4 AD       1998 0.138 </span></span>
<span><span class="co">#&gt;  5 AD       1999 0.159 </span></span>
<span><span class="co">#&gt;  6 AD       2000 0.182 </span></span>
<span><span class="co">#&gt;  7 AD       2001 0.207 </span></span>
<span><span class="co">#&gt;  8 AD       2002 0.234 </span></span>
<span><span class="co">#&gt;  9 AD       2003 0.263 </span></span>
<span><span class="co">#&gt; 10 AD       2004 0.294 </span></span>
<span><span class="co">#&gt; # ℹ 8,773 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">private</span> <span class="op">&lt;-</span> <span class="va">wwealp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">year</span>, private <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span><span class="va">private</span></span>
<span><span class="co">#&gt; # A tibble: 8,989 × 3</span></span>
<span><span class="co">#&gt;    country  year private</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 AD       1995   0.441</span></span>
<span><span class="co">#&gt;  2 AD       1996   0.488</span></span>
<span><span class="co">#&gt;  3 AD       1997   0.534</span></span>
<span><span class="co">#&gt;  4 AD       1998   0.582</span></span>
<span><span class="co">#&gt;  5 AD       1999   0.628</span></span>
<span><span class="co">#&gt;  6 AD       2000   0.678</span></span>
<span><span class="co">#&gt;  7 AD       2001   0.727</span></span>
<span><span class="co">#&gt;  8 AD       2002   0.778</span></span>
<span><span class="co">#&gt;  9 AD       2003   0.834</span></span>
<span><span class="co">#&gt; 10 AD       2004   0.894</span></span>
<span><span class="co">#&gt; # ℹ 8,979 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">public_vs_private</span> <span class="op">&lt;-</span> <span class="va">public</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">private</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(country, year)`</span></span>
<span><span class="va">public_vs_private</span></span>
<span><span class="co">#&gt; # A tibble: 8,783 × 4</span></span>
<span><span class="co">#&gt;    country  year public private</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 AD       1995 0.0765   0.441</span></span>
<span><span class="co">#&gt;  2 AD       1996 0.0973   0.488</span></span>
<span><span class="co">#&gt;  3 AD       1997 0.118    0.534</span></span>
<span><span class="co">#&gt;  4 AD       1998 0.138    0.582</span></span>
<span><span class="co">#&gt;  5 AD       1999 0.159    0.628</span></span>
<span><span class="co">#&gt;  6 AD       2000 0.182    0.678</span></span>
<span><span class="co">#&gt;  7 AD       2001 0.207    0.727</span></span>
<span><span class="co">#&gt;  8 AD       2002 0.234    0.778</span></span>
<span><span class="co">#&gt;  9 AD       2003 0.263    0.834</span></span>
<span><span class="co">#&gt; 10 AD       2004 0.294    0.894</span></span>
<span><span class="co">#&gt; # ℹ 8,773 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_pub_priv</span> <span class="op">&lt;-</span> <span class="va">public_vs_private</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"category"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">wdi_cache</span><span class="op">$</span><span class="va">country</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"country"</span><span class="op">=</span><span class="st">"iso2c"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>country <span class="op">=</span> <span class="va">country.y</span>, iso2c <span class="op">=</span> <span class="va">country</span>, <span class="va">year</span>, <span class="va">category</span>, <span class="va">value</span>, <span class="va">region</span>, <span class="va">income</span>, <span class="va">lending</span><span class="op">)</span></span>
<span><span class="va">df_pub_priv</span></span>
<span><span class="co">#&gt; # A tibble: 17,566 × 8</span></span>
<span><span class="co">#&gt;    country iso2c  year category  value region income lending</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  </span></span>
<span><span class="co">#&gt;  1 Andorra AD     1995 public   0.0765 Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  2 Andorra AD     1995 private  0.441  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  3 Andorra AD     1996 public   0.0973 Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  4 Andorra AD     1996 private  0.488  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  5 Andorra AD     1997 public   0.118  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  6 Andorra AD     1997 private  0.534  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  7 Andorra AD     1998 public   0.138  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  8 Andorra AD     1998 private  0.582  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt;  9 Andorra AD     1999 public   0.159  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt; 10 Andorra AD     1999 private  0.628  Europ… High … Not cl…</span></span>
<span><span class="co">#&gt; # ℹ 17,556 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb414"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df_pub_priv</span><span class="op">$</span><span class="va">country</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "Andorra"                                     </span></span>
<span><span class="co">#&gt;   [2] "United Arab Emirates"                        </span></span>
<span><span class="co">#&gt;   [3] "Afghanistan"                                 </span></span>
<span><span class="co">#&gt;   [4] "Antigua and Barbuda"                         </span></span>
<span><span class="co">#&gt;   [5] NA                                            </span></span>
<span><span class="co">#&gt;   [6] "Albania"                                     </span></span>
<span><span class="co">#&gt;   [7] "Armenia"                                     </span></span>
<span><span class="co">#&gt;   [8] "Angola"                                      </span></span>
<span><span class="co">#&gt;   [9] "Argentina"                                   </span></span>
<span><span class="co">#&gt;  [10] "American Samoa"                              </span></span>
<span><span class="co">#&gt;  [11] "Austria"                                     </span></span>
<span><span class="co">#&gt;  [12] "Australia"                                   </span></span>
<span><span class="co">#&gt;  [13] "Aruba"                                       </span></span>
<span><span class="co">#&gt;  [14] "Azerbaijan"                                  </span></span>
<span><span class="co">#&gt;  [15] "Bosnia and Herzegovina"                      </span></span>
<span><span class="co">#&gt;  [16] "Barbados"                                    </span></span>
<span><span class="co">#&gt;  [17] "Bangladesh"                                  </span></span>
<span><span class="co">#&gt;  [18] "Belgium"                                     </span></span>
<span><span class="co">#&gt;  [19] "Burkina Faso"                                </span></span>
<span><span class="co">#&gt;  [20] "Bulgaria"                                    </span></span>
<span><span class="co">#&gt;  [21] "Bahrain"                                     </span></span>
<span><span class="co">#&gt;  [22] "Burundi"                                     </span></span>
<span><span class="co">#&gt;  [23] "Benin"                                       </span></span>
<span><span class="co">#&gt;  [24] "Bermuda"                                     </span></span>
<span><span class="co">#&gt;  [25] "Brunei Darussalam"                           </span></span>
<span><span class="co">#&gt;  [26] "Bolivia"                                     </span></span>
<span><span class="co">#&gt;  [27] "Brazil"                                      </span></span>
<span><span class="co">#&gt;  [28] "Bahamas, The"                                </span></span>
<span><span class="co">#&gt;  [29] "Bhutan"                                      </span></span>
<span><span class="co">#&gt;  [30] "Botswana"                                    </span></span>
<span><span class="co">#&gt;  [31] "Belize"                                      </span></span>
<span><span class="co">#&gt;  [32] "Canada"                                      </span></span>
<span><span class="co">#&gt;  [33] "Congo, Dem. Rep."                            </span></span>
<span><span class="co">#&gt;  [34] "Central African Republic"                    </span></span>
<span><span class="co">#&gt;  [35] "Congo, Rep."                                 </span></span>
<span><span class="co">#&gt;  [36] "Switzerland"                                 </span></span>
<span><span class="co">#&gt;  [37] "Cote d'Ivoire"                               </span></span>
<span><span class="co">#&gt;  [38] "Chile"                                       </span></span>
<span><span class="co">#&gt;  [39] "Cameroon"                                    </span></span>
<span><span class="co">#&gt;  [40] "China"                                       </span></span>
<span><span class="co">#&gt;  [41] "Colombia"                                    </span></span>
<span><span class="co">#&gt;  [42] "Costa Rica"                                  </span></span>
<span><span class="co">#&gt;  [43] "Cuba"                                        </span></span>
<span><span class="co">#&gt;  [44] "Cabo Verde"                                  </span></span>
<span><span class="co">#&gt;  [45] "Curacao"                                     </span></span>
<span><span class="co">#&gt;  [46] "Cyprus"                                      </span></span>
<span><span class="co">#&gt;  [47] "Czechia"                                     </span></span>
<span><span class="co">#&gt;  [48] "Germany"                                     </span></span>
<span><span class="co">#&gt;  [49] "Djibouti"                                    </span></span>
<span><span class="co">#&gt;  [50] "Denmark"                                     </span></span>
<span><span class="co">#&gt;  [51] "Dominica"                                    </span></span>
<span><span class="co">#&gt;  [52] "Dominican Republic"                          </span></span>
<span><span class="co">#&gt;  [53] "Algeria"                                     </span></span>
<span><span class="co">#&gt;  [54] "Ecuador"                                     </span></span>
<span><span class="co">#&gt;  [55] "Estonia"                                     </span></span>
<span><span class="co">#&gt;  [56] "Egypt, Arab Rep."                            </span></span>
<span><span class="co">#&gt;  [57] "Eritrea"                                     </span></span>
<span><span class="co">#&gt;  [58] "Spain"                                       </span></span>
<span><span class="co">#&gt;  [59] "Ethiopia"                                    </span></span>
<span><span class="co">#&gt;  [60] "Finland"                                     </span></span>
<span><span class="co">#&gt;  [61] "Fiji"                                        </span></span>
<span><span class="co">#&gt;  [62] "Micronesia, Fed. Sts."                       </span></span>
<span><span class="co">#&gt;  [63] "France"                                      </span></span>
<span><span class="co">#&gt;  [64] "Gabon"                                       </span></span>
<span><span class="co">#&gt;  [65] "United Kingdom"                              </span></span>
<span><span class="co">#&gt;  [66] "Grenada"                                     </span></span>
<span><span class="co">#&gt;  [67] "Georgia"                                     </span></span>
<span><span class="co">#&gt;  [68] "Ghana"                                       </span></span>
<span><span class="co">#&gt;  [69] "Greenland"                                   </span></span>
<span><span class="co">#&gt;  [70] "Gambia, The"                                 </span></span>
<span><span class="co">#&gt;  [71] "Guinea"                                      </span></span>
<span><span class="co">#&gt;  [72] "Equatorial Guinea"                           </span></span>
<span><span class="co">#&gt;  [73] "Greece"                                      </span></span>
<span><span class="co">#&gt;  [74] "Guatemala"                                   </span></span>
<span><span class="co">#&gt;  [75] "Guam"                                        </span></span>
<span><span class="co">#&gt;  [76] "Guinea-Bissau"                               </span></span>
<span><span class="co">#&gt;  [77] "Guyana"                                      </span></span>
<span><span class="co">#&gt;  [78] "Hong Kong SAR, China"                        </span></span>
<span><span class="co">#&gt;  [79] "Honduras"                                    </span></span>
<span><span class="co">#&gt;  [80] "Croatia"                                     </span></span>
<span><span class="co">#&gt;  [81] "Haiti"                                       </span></span>
<span><span class="co">#&gt;  [82] "Hungary"                                     </span></span>
<span><span class="co">#&gt;  [83] "Indonesia"                                   </span></span>
<span><span class="co">#&gt;  [84] "Ireland"                                     </span></span>
<span><span class="co">#&gt;  [85] "Israel"                                      </span></span>
<span><span class="co">#&gt;  [86] "Isle of Man"                                 </span></span>
<span><span class="co">#&gt;  [87] "India"                                       </span></span>
<span><span class="co">#&gt;  [88] "Iraq"                                        </span></span>
<span><span class="co">#&gt;  [89] "Iran, Islamic Rep."                          </span></span>
<span><span class="co">#&gt;  [90] "Iceland"                                     </span></span>
<span><span class="co">#&gt;  [91] "Italy"                                       </span></span>
<span><span class="co">#&gt;  [92] "Jamaica"                                     </span></span>
<span><span class="co">#&gt;  [93] "Jordan"                                      </span></span>
<span><span class="co">#&gt;  [94] "Japan"                                       </span></span>
<span><span class="co">#&gt;  [95] "Kenya"                                       </span></span>
<span><span class="co">#&gt;  [96] "Kyrgyz Republic"                             </span></span>
<span><span class="co">#&gt;  [97] "Cambodia"                                    </span></span>
<span><span class="co">#&gt;  [98] "Kiribati"                                    </span></span>
<span><span class="co">#&gt;  [99] "Comoros"                                     </span></span>
<span><span class="co">#&gt; [100] "St. Kitts and Nevis"                         </span></span>
<span><span class="co">#&gt; [101] "Korea, Dem. People's Rep."                   </span></span>
<span><span class="co">#&gt; [102] "Korea, Rep."                                 </span></span>
<span><span class="co">#&gt; [103] "Kuwait"                                      </span></span>
<span><span class="co">#&gt; [104] "Cayman Islands"                              </span></span>
<span><span class="co">#&gt; [105] "Kazakhstan"                                  </span></span>
<span><span class="co">#&gt; [106] "Lao PDR"                                     </span></span>
<span><span class="co">#&gt; [107] "Lebanon"                                     </span></span>
<span><span class="co">#&gt; [108] "St. Lucia"                                   </span></span>
<span><span class="co">#&gt; [109] "Liechtenstein"                               </span></span>
<span><span class="co">#&gt; [110] "Sri Lanka"                                   </span></span>
<span><span class="co">#&gt; [111] "Liberia"                                     </span></span>
<span><span class="co">#&gt; [112] "Lesotho"                                     </span></span>
<span><span class="co">#&gt; [113] "Lithuania"                                   </span></span>
<span><span class="co">#&gt; [114] "Luxembourg"                                  </span></span>
<span><span class="co">#&gt; [115] "Latvia"                                      </span></span>
<span><span class="co">#&gt; [116] "Libya"                                       </span></span>
<span><span class="co">#&gt; [117] "Morocco"                                     </span></span>
<span><span class="co">#&gt; [118] "Monaco"                                      </span></span>
<span><span class="co">#&gt; [119] "Moldova"                                     </span></span>
<span><span class="co">#&gt; [120] "Montenegro"                                  </span></span>
<span><span class="co">#&gt; [121] "Madagascar"                                  </span></span>
<span><span class="co">#&gt; [122] "Marshall Islands"                            </span></span>
<span><span class="co">#&gt; [123] "North Macedonia"                             </span></span>
<span><span class="co">#&gt; [124] "Mali"                                        </span></span>
<span><span class="co">#&gt; [125] "Myanmar"                                     </span></span>
<span><span class="co">#&gt; [126] "Mongolia"                                    </span></span>
<span><span class="co">#&gt; [127] "Macao SAR, China"                            </span></span>
<span><span class="co">#&gt; [128] "Northern Mariana Islands"                    </span></span>
<span><span class="co">#&gt; [129] "Mauritania"                                  </span></span>
<span><span class="co">#&gt; [130] "Malta"                                       </span></span>
<span><span class="co">#&gt; [131] "Mauritius"                                   </span></span>
<span><span class="co">#&gt; [132] "Maldives"                                    </span></span>
<span><span class="co">#&gt; [133] "Malawi"                                      </span></span>
<span><span class="co">#&gt; [134] "Mexico"                                      </span></span>
<span><span class="co">#&gt; [135] "Malaysia"                                    </span></span>
<span><span class="co">#&gt; [136] "Mozambique"                                  </span></span>
<span><span class="co">#&gt; [137] "New Caledonia"                               </span></span>
<span><span class="co">#&gt; [138] "Niger"                                       </span></span>
<span><span class="co">#&gt; [139] "Nigeria"                                     </span></span>
<span><span class="co">#&gt; [140] "Nicaragua"                                   </span></span>
<span><span class="co">#&gt; [141] "Netherlands"                                 </span></span>
<span><span class="co">#&gt; [142] "Norway"                                      </span></span>
<span><span class="co">#&gt; [143] "Nepal"                                       </span></span>
<span><span class="co">#&gt; [144] "Nauru"                                       </span></span>
<span><span class="co">#&gt; [145] "New Zealand"                                 </span></span>
<span><span class="co">#&gt; [146] "OECD members"                                </span></span>
<span><span class="co">#&gt; [147] "Oman"                                        </span></span>
<span><span class="co">#&gt; [148] "Panama"                                      </span></span>
<span><span class="co">#&gt; [149] "Peru"                                        </span></span>
<span><span class="co">#&gt; [150] "French Polynesia"                            </span></span>
<span><span class="co">#&gt; [151] "Papua New Guinea"                            </span></span>
<span><span class="co">#&gt; [152] "Philippines"                                 </span></span>
<span><span class="co">#&gt; [153] "Pakistan"                                    </span></span>
<span><span class="co">#&gt; [154] "Poland"                                      </span></span>
<span><span class="co">#&gt; [155] "Puerto Rico"                                 </span></span>
<span><span class="co">#&gt; [156] "West Bank and Gaza"                          </span></span>
<span><span class="co">#&gt; [157] "Portugal"                                    </span></span>
<span><span class="co">#&gt; [158] "Palau"                                       </span></span>
<span><span class="co">#&gt; [159] "Paraguay"                                    </span></span>
<span><span class="co">#&gt; [160] "Qatar"                                       </span></span>
<span><span class="co">#&gt; [161] "Romania"                                     </span></span>
<span><span class="co">#&gt; [162] "Serbia"                                      </span></span>
<span><span class="co">#&gt; [163] "Russian Federation"                          </span></span>
<span><span class="co">#&gt; [164] "Rwanda"                                      </span></span>
<span><span class="co">#&gt; [165] "Saudi Arabia"                                </span></span>
<span><span class="co">#&gt; [166] "Solomon Islands"                             </span></span>
<span><span class="co">#&gt; [167] "Seychelles"                                  </span></span>
<span><span class="co">#&gt; [168] "Sudan"                                       </span></span>
<span><span class="co">#&gt; [169] "Sweden"                                      </span></span>
<span><span class="co">#&gt; [170] "Singapore"                                   </span></span>
<span><span class="co">#&gt; [171] "Slovenia"                                    </span></span>
<span><span class="co">#&gt; [172] "Slovak Republic"                             </span></span>
<span><span class="co">#&gt; [173] "Sierra Leone"                                </span></span>
<span><span class="co">#&gt; [174] "San Marino"                                  </span></span>
<span><span class="co">#&gt; [175] "Senegal"                                     </span></span>
<span><span class="co">#&gt; [176] "Somalia"                                     </span></span>
<span><span class="co">#&gt; [177] "Suriname"                                    </span></span>
<span><span class="co">#&gt; [178] "South Sudan"                                 </span></span>
<span><span class="co">#&gt; [179] "Sao Tome and Principe"                       </span></span>
<span><span class="co">#&gt; [180] "El Salvador"                                 </span></span>
<span><span class="co">#&gt; [181] "Sint Maarten (Dutch part)"                   </span></span>
<span><span class="co">#&gt; [182] "Syrian Arab Republic"                        </span></span>
<span><span class="co">#&gt; [183] "Eswatini"                                    </span></span>
<span><span class="co">#&gt; [184] "Turks and Caicos Islands"                    </span></span>
<span><span class="co">#&gt; [185] "Chad"                                        </span></span>
<span><span class="co">#&gt; [186] "Togo"                                        </span></span>
<span><span class="co">#&gt; [187] "Thailand"                                    </span></span>
<span><span class="co">#&gt; [188] "Tajikistan"                                  </span></span>
<span><span class="co">#&gt; [189] "Timor-Leste"                                 </span></span>
<span><span class="co">#&gt; [190] "Turkmenistan"                                </span></span>
<span><span class="co">#&gt; [191] "Tunisia"                                     </span></span>
<span><span class="co">#&gt; [192] "Tonga"                                       </span></span>
<span><span class="co">#&gt; [193] "Turkiye"                                     </span></span>
<span><span class="co">#&gt; [194] "Trinidad and Tobago"                         </span></span>
<span><span class="co">#&gt; [195] "Tuvalu"                                      </span></span>
<span><span class="co">#&gt; [196] "Taiwan, China"                               </span></span>
<span><span class="co">#&gt; [197] "Tanzania"                                    </span></span>
<span><span class="co">#&gt; [198] "Ukraine"                                     </span></span>
<span><span class="co">#&gt; [199] "Uganda"                                      </span></span>
<span><span class="co">#&gt; [200] "United States"                               </span></span>
<span><span class="co">#&gt; [201] "Uruguay"                                     </span></span>
<span><span class="co">#&gt; [202] "Uzbekistan"                                  </span></span>
<span><span class="co">#&gt; [203] "St. Vincent and the Grenadines"              </span></span>
<span><span class="co">#&gt; [204] "Venezuela, RB"                               </span></span>
<span><span class="co">#&gt; [205] "British Virgin Islands"                      </span></span>
<span><span class="co">#&gt; [206] "Virgin Islands (U.S.)"                       </span></span>
<span><span class="co">#&gt; [207] "Vietnam"                                     </span></span>
<span><span class="co">#&gt; [208] "Vanuatu"                                     </span></span>
<span><span class="co">#&gt; [209] "Samoa"                                       </span></span>
<span><span class="co">#&gt; [210] "IBRD only"                                   </span></span>
<span><span class="co">#&gt; [211] "IDA only"                                    </span></span>
<span><span class="co">#&gt; [212] "Least developed countries: UN classification"</span></span>
<span><span class="co">#&gt; [213] "Low income"                                  </span></span>
<span><span class="co">#&gt; [214] "Lower middle income"                         </span></span>
<span><span class="co">#&gt; [215] "Yemen, Rep."                                 </span></span>
<span><span class="co">#&gt; [216] "South Africa"                                </span></span>
<span><span class="co">#&gt; [217] "Zambia"                                      </span></span>
<span><span class="co">#&gt; [218] "Zimbabwe"</span></span></code></pre></div>
<div class="sourceCode" id="cb415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_pub_priv</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Japan"</span>, <span class="st">"Norway"</span>, <span class="st">"Sweden"</span>, <span class="st">"Denmark"</span>, <span class="st">"Finland"</span><span class="op">)</span>, <span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1970</span><span class="op">:</span><span class="fl">2020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">country</span>, linetype <span class="op">=</span> <span class="va">category</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-a4resp_files/figure-html/unnamed-chunk-77-1.png" width="672"></div>
<p>We choose two indicators: ‘wealg’ and ‘wealp’. WIR2022 indicators consists of 6 characters; 1 letter code plus 5 letter code. You can find the list in the codebook.</p>
<p>If you want to study WIR2022, please study the <a href="https://wir2022.wid.world/">report</a>, the <a href="https://wid.world/codes-dictionary">codebook</a>, and wir <a href="https://ds-sl.github.io/data-analysis/wir_download.pdf">vignette</a> together with the <a href="https://ds-sl.github.io/data-analysis/wir2022.nb.html">R Notebook</a>.</p>
<p>As I mentioned earlier, the data tables used in the report are available from the following page.</p>
<ul>
<li>Methodology: <a href="https://wir2022.wid.world/methodology/" class="uri">https://wir2022.wid.world/methodology/</a>
</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="workflow.html"><span class="header-section-number">11</span> Workflow</a></div>
<div class="next"><a href="model.html"><span class="header-section-number">13</span> Linear Model</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#a4resp"><span class="header-section-number">12</span> Assignment Four</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#assignment-four-the-week-five-assignment">Assignment Four: The Week Five Assignment</a></li></ul>
</li>
<li>
<a class="nav-link" href="#set-up-4"><span class="header-section-number">12.1</span> Set up</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#world-development-indicator---wdi"><span class="header-section-number">12.1.1</span> World Development Indicator - WDI</a></li>
<li><a class="nav-link" href="#world-inequility-report---wir2022"><span class="header-section-number">12.1.2</span> World Inequility Report - WIR2022</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#general-comments-2"><span class="header-section-number">12.2</span> General Comments</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#reproducibility-and-literate-programming"><span class="header-section-number">12.2.1</span> Reproducibility and Literate Programming</a></li>
<li><a class="nav-link" href="#varibles-2"><span class="header-section-number">12.2.2</span> Varibles</a></li>
<li><a class="nav-link" href="#visualization-1"><span class="header-section-number">12.2.3</span> Visualization</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#your-work"><span class="header-section-number">12.3</span> Your Work</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#world-inequality-report-2022---wir"><span class="header-section-number">12.3.1</span> World Inequality Report 2022 - WIR</a></li>
<li><a class="nav-link" href="#world-development-indicators---wdi"><span class="header-section-number">12.3.2</span> World Development Indicators - WDI</a></li>
<li><a class="nav-link" href="#united-nations---undata"><span class="header-section-number">12.3.3</span> United Nations - UNdata</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#responses-to-questions-2"><span class="header-section-number">12.4</span> Responses to Questions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#q.-wir2022-f8-with-a-fixed-year-say-2020-describing-the-difference-of-goevernment-and-private-income."><span class="header-section-number">12.4.1</span> Q. WIR2022, F8 with a fixed year, say 2020 describing the difference of goevernment and private income.</a></li>
<li><a class="nav-link" href="#q.-the-line-graph-looked-strange-at-first-and-i-couldnt-really-see-the-results-clearly.-however-i-could-solve-that-problem-by-using-smoothstat-and-then-the-results-looked-way-better-and-i-was-able-to-interpret-them-easily."><span class="header-section-number">12.4.2</span> Q. The line graph looked strange at first and I couldn’t really see the results clearly. However, I could solve that problem by using “smoothstat” and then the results looked way better and I was able to interpret them easily.</a></li>
<li><a class="nav-link" href="#q.-how-is-it-possible-to-organize-better-the-name-of-the-value-in-the-x-axis-so-that-they-are-better-readable"><span class="header-section-number">12.4.3</span> Q. How is it possible to organize better the name of the value in the x axis so that they are better readable?</a></li>
<li><a class="nav-link" href="#q.-position-of-the-labels"><span class="header-section-number">12.4.4</span> Q. Position of the labels</a></li>
<li><a class="nav-link" href="#visualization-by-charts"><span class="header-section-number">12.4.5</span> Visualization by Charts</a></li>
<li><a class="nav-link" href="#un-data"><span class="header-section-number">12.4.6</span> UN Data</a></li>
</ul>
</li>
<li><a class="nav-link" href="#wir-package"><span class="header-section-number">12.5</span> WIR Package</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/icu-hsuzuki/da4r2022/blob/master/12-a4resp.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/icu-hsuzuki/da4r2022/edit/master/12-a4resp.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Analysis for Researchers AY2022</strong>" was written by Hiroshi Suzuki. It was last built on 2023-05-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
