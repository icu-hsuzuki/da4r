# Covid 19 {#covid19}

> An example of an R Notebook, rendered at 2023-02-11 23:39:42 JST  


## Introduction

The following site of Johns Hopkins University is famous:

* https://coronavirus.jhu.edu/map.html

In this article, we study a coronavirus data collected by Johns Hopkins University called "JHU Covid-19 global time series data". Since the original data requires reshaping, we use the data provided by RamiKrispin in the following site.

* https://github.com/RamiKrispin/coronavirus/tree/master/csv

See also the R package `coronavirus` at

* https://CRAN.R-project.org/package=coronavirus
* For installation: 


```r
install.packages("coronavirus")
```


```r
library(tidyverse)
#> ── Attaching packages ─────────────────── tidyverse 1.3.2 ──
#> ✔ ggplot2 3.4.0      ✔ purrr   1.0.0 
#> ✔ tibble  3.1.8      ✔ dplyr   1.0.10
#> ✔ tidyr   1.2.1      ✔ stringr 1.5.0 
#> ✔ readr   2.1.3      ✔ forcats 0.5.2 
#> ── Conflicts ────────────────────── tidyverse_conflicts() ──
#> ✖ dplyr::filter() masks stats::filter()
#> ✖ dplyr::lag()    masks stats::lag()
library(coronavirus)
library(owidR)
```

We can directly download and read the data from:

* https://github.com/RamiKrispin/coronavirus/raw/master/csv/coronavirus.csv

It is updated daily.

In this note, we use the original JHU data and transform it using `dplyr` in the form similar to the  Krispin's.

Our world in data also provides vairous data related to covid-19.

##### `owid_covid`

owid_covid: Get the Our World in Data covid-19 dataset

```
owid_covid()
```

See the detail at the [GitHub site](https://github.com/owid/covid-19-data/tree/master/public/data#data-on-covid-19-coronavirus-by-our-world-in-data).

* Example


```r
covid <- owid_covid()
```


```r
glimpse(covid)
#> Rows: 256,343
#> Columns: 67
#> $ iso_code                                   <chr> "AFG", …
#> $ continent                                  <chr> "Asia",…
#> $ location                                   <chr> "Afghan…
#> $ date                                       <date> 2020-0…
#> $ total_cases                                <dbl> 5, 5, 5…
#> $ new_cases                                  <dbl> 5, 0, 0…
#> $ new_cases_smoothed                         <dbl> NA, NA,…
#> $ total_deaths                               <dbl> NA, NA,…
#> $ new_deaths                                 <dbl> NA, NA,…
#> $ new_deaths_smoothed                        <dbl> NA, NA,…
#> $ total_cases_per_million                    <dbl> 0.122, …
#> $ new_cases_per_million                      <dbl> 0.122, …
#> $ new_cases_smoothed_per_million             <dbl> NA, NA,…
#> $ total_deaths_per_million                   <dbl> NA, NA,…
#> $ new_deaths_per_million                     <dbl> NA, NA,…
#> $ new_deaths_smoothed_per_million            <dbl> NA, NA,…
#> $ reproduction_rate                          <dbl> NA, NA,…
#> $ icu_patients                               <dbl> NA, NA,…
#> $ icu_patients_per_million                   <dbl> NA, NA,…
#> $ hosp_patients                              <dbl> NA, NA,…
#> $ hosp_patients_per_million                  <dbl> NA, NA,…
#> $ weekly_icu_admissions                      <dbl> NA, NA,…
#> $ weekly_icu_admissions_per_million          <dbl> NA, NA,…
#> $ weekly_hosp_admissions                     <dbl> NA, NA,…
#> $ weekly_hosp_admissions_per_million         <dbl> NA, NA,…
#> $ total_tests                                <dbl> NA, NA,…
#> $ new_tests                                  <dbl> NA, NA,…
#> $ total_tests_per_thousand                   <dbl> NA, NA,…
#> $ new_tests_per_thousand                     <dbl> NA, NA,…
#> $ new_tests_smoothed                         <dbl> NA, NA,…
#> $ new_tests_smoothed_per_thousand            <dbl> NA, NA,…
#> $ positive_rate                              <dbl> NA, NA,…
#> $ tests_per_case                             <dbl> NA, NA,…
#> $ tests_units                                <chr> NA, NA,…
#> $ total_vaccinations                         <dbl> NA, NA,…
#> $ people_vaccinated                          <dbl> NA, NA,…
#> $ people_fully_vaccinated                    <dbl> NA, NA,…
#> $ total_boosters                             <dbl> NA, NA,…
#> $ new_vaccinations                           <dbl> NA, NA,…
#> $ new_vaccinations_smoothed                  <dbl> NA, NA,…
#> $ total_vaccinations_per_hundred             <dbl> NA, NA,…
#> $ people_vaccinated_per_hundred              <dbl> NA, NA,…
#> $ people_fully_vaccinated_per_hundred        <dbl> NA, NA,…
#> $ total_boosters_per_hundred                 <dbl> NA, NA,…
#> $ new_vaccinations_smoothed_per_million      <dbl> NA, NA,…
#> $ new_people_vaccinated_smoothed             <dbl> NA, NA,…
#> $ new_people_vaccinated_smoothed_per_hundred <dbl> NA, NA,…
#> $ stringency_index                           <dbl> 8.33, 8…
#> $ population_density                         <dbl> 54.422,…
#> $ median_age                                 <dbl> 18.6, 1…
#> $ aged_65_older                              <dbl> 2.581, …
#> $ aged_70_older                              <dbl> 1.337, …
#> $ gdp_per_capita                             <dbl> 1803.98…
#> $ extreme_poverty                            <dbl> NA, NA,…
#> $ cardiovasc_death_rate                      <dbl> 597.029…
#> $ diabetes_prevalence                        <dbl> 9.59, 9…
#> $ female_smokers                             <dbl> NA, NA,…
#> $ male_smokers                               <dbl> NA, NA,…
#> $ handwashing_facilities                     <dbl> 37.746,…
#> $ hospital_beds_per_thousand                 <dbl> 0.5, 0.…
#> $ life_expectancy                            <dbl> 64.83, …
#> $ human_development_index                    <dbl> 0.511, …
#> $ population                                 <dbl> 4112877…
#> $ excess_mortality_cumulative_absolute       <dbl> NA, NA,…
#> $ excess_mortality_cumulative                <dbl> NA, NA,…
#> $ excess_mortality                           <dbl> NA, NA,…
#> $ excess_mortality_cumulative_per_million    <dbl> NA, NA,…
```



```r
tdpm <- covid %>% drop_na(total_deaths_per_million) %>%
  group_by(location) %>% 
  summarize(total_deaths_per_million = max(total_deaths_per_million)) %>%
  arrange(desc(total_deaths_per_million))
DT::datatable(tdpm)
```

```{=html}
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4ea912450732916d24b7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4ea912450732916d24b7">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226"],["Peru","Bulgaria","Bosnia and Herzegovina","Hungary","North Macedonia","Georgia","Montenegro","Croatia","Czechia","Slovakia","Moldova","San Marino","Lithuania","Romania","Gibraltar","Latvia","Greece","Slovenia","United States","Chile","Brazil","United Kingdom","Italy","Armenia","South America","Ukraine","Poland","Paraguay","Belgium","Argentina","Trinidad and Tobago","Colombia","Europe","European Union","Russia","Aruba","North America","Mexico","Serbia","Portugal","Spain","Bermuda","Austria","France","Tunisia","High income","Saint Lucia","Suriname","Liechtenstein","Sweden","Uruguay","Estonia","French Polynesia","Andorra","British Virgin Islands","Barbados","Bahamas","Germany","Ecuador","Lebanon","Panama","Grenada","Luxembourg","Monaco","Bolivia","Montserrat","Kosovo","Hong Kong","Costa Rica","South Africa","Ireland","Belize","Iran","Switzerland","Seychelles","Guyana","Namibia","Finland","Curacao","Antigua and Barbuda","Malta","Bonaire Sint Eustatius and Saba","Cyprus","Denmark","Isle of Man","Canada","Netherlands","Israel","Albania","Jordan","Jamaica","Turkey","Eswatini","Saint Vincent and the Grenadines","Guatemala","Botswana","Malaysia","Palestine","New Caledonia","Honduras","Bahrain","Upper middle income","Dominica","Oman","Kazakhstan","Azerbaijan","Saint Kitts and Nevis","Fiji","Norway","Libya","World","Turks and Caicos Islands","Mauritius","Sri Lanka","Cuba","Anguilla","Belarus","Australia","Taiwan","Cape Verde","El Salvador","South Korea","Iceland","Mongolia","Wallis and Futuna","Kuwait","Maldives","Indonesia","Philippines","Iraq","Japan","Oceania","Cayman Islands","Faeroe Islands","Micronesia (country)","Brunei","Palau","New Zealand","Thailand","Kyrgyzstan","Vietnam","Morocco","Marshall Islands","Nepal","Lower middle income","Dominican Republic","India","Greenland","Myanmar","Zimbabwe","Asia","Saint Pierre and Miquelon","Sao Tome and Principe","Lesotho","Singapore","Saudi Arabia","Qatar","United Arab Emirates","Egypt","Solomon Islands","Mauritania","Venezuela","Zambia","Comoros","Afghanistan","Cambodia","Africa","Macao","Bangladesh","Djibouti","Algeria","Syria","Malawi","Gambia","Kiribati","Samoa","Pakistan","Gabon","Tonga","Cook Islands","Senegal","Equatorial Guinea","Sudan","Rwanda","Kenya","Timor","Laos","Guinea-Bissau","Nauru","Somalia","Uganda","Haiti","Cameroon","Mozambique","Papua New Guinea","Congo","Low income","Yemen","Ethiopia","China","Liberia","Angola","Madagascar","Uzbekistan","Ghana","Vanuatu","Nicaragua","Guinea","Mali","Togo","Cote d'Ivoire","Eritrea","Bhutan","Central African Republic","Burkina Faso","Democratic Republic of Congo","Sierra Leone","Nigeria","Tanzania","South Sudan","Tajikistan","Benin","Niger","Chad","Burundi","North Korea"],[6438.521,5631.562,5028.869,4886.677,4604.973,4524.374,4461.936,4444.019,4034.5,3716.34,3653.231,3621.253,3474.836,3439.548,3396.885,3373.402,3348.974,3331.851,3293.77,3261.674,3240.219,3224.832,3172.087,3135.799,3085.633,2999.591,2979.817,2924.457,2884.027,2866.097,2825.525,2742.721,2719.942,2686.506,2677.632,2648.907,2626.776,2608.386,2580.351,2536.497,2496.119,2460.791,2435.563,2427.057,2372.266,2281.753,2273.839,2265.204,2261.466,2233.598,2224.497,2201.251,2118.893,2066.556,2042.64,2034.469,2031.762,1999.044,1997.944,1967.487,1950.514,1897.034,1871.523,1836.069,1828.681,1812.826,1797.864,1780.377,1772.108,1712.946,1712.486,1697.571,1634.942,1629.66,1605.451,1602.519,1592.506,1592.024,1574.49,1556.968,1548.867,1515.6,1440.837,1392.152,1372.229,1323.752,1314.107,1294.105,1265.165,1251.299,1233.65,1189.249,1184.175,1183.159,1128.62,1093.411,1088.625,1087.222,1082.912,1064.617,1048.744,1031.134,1017.07,1011.297,982.885,974.795,964.745,949.698,945.288,944.902,859.09,831.037,803.4,770.79,760.779,755.81,746.516,728.223,707.057,696.268,667.572,650.323,638.236,628.536,603.656,602.031,593.74,583.863,570.306,570.274,566.293,541.799,538.401,527.138,507.979,501.111,497.678,482.519,472.572,451.089,439.835,435.048,408.723,393.484,392.014,390.424,374.513,371.721,359.731,346.741,342.841,339.847,338.621,313.554,305.48,263.315,254.533,248.699,223.506,211.247,210.509,206.737,202.321,192.404,191.982,182.254,180.57,174.056,172,168.622,153.241,143.004,141.924,137.473,137.156,130.402,129.927,128.087,121.647,117.426,114.804,109.259,106.839,106.557,105.28,102.885,100.671,83.587,78.796,77.34,76.826,74.234,70.393,67.851,66.058,64.987,64.977,64.072,61.371,61.343,55.444,54.258,47.954,47.274,43.673,42.847,35.26,33.696,32.885,32.773,29.58,27.958,26.839,20.254,17.465,14.776,14.641,14.437,12.916,12.645,12.559,12.207,12.019,10.946,2.948,0.23]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>location<\/th>\n      <th>total_deaths_per_million<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
```


```r
covid %>% drop_na(total_deaths_per_million) %>%
  group_by(location) %>% 
  summarize(total_deaths_per_million = max(total_deaths_per_million), .groups = "drop") %>%
  arrange(desc(total_deaths_per_million)) %>%
  ggplot(aes(x = total_deaths_per_million)) + geom_histogram(bins = 30)
```

<img src="42-covid19_files/figure-html/unnamed-chunk-6-1.png" width="672" />


```r
covid %>% filter(location == "Japan") %>% arrange(desc(date))
#> # A tibble: 1,115 × 67
#>    iso_code continent location date       total_ca…¹ new_c…²
#>    <chr>    <chr>     <chr>    <date>          <dbl>   <dbl>
#>  1 JPN      Asia      Japan    2023-02-09   32901767   32969
#>  2 JPN      Asia      Japan    2023-02-08   32868798   41584
#>  3 JPN      Asia      Japan    2023-02-07   32827214   44755
#>  4 JPN      Asia      Japan    2023-02-06   32782459   15612
#>  5 JPN      Asia      Japan    2023-02-05   32766847   32459
#>  6 JPN      Asia      Japan    2023-02-04   32734388   38581
#>  7 JPN      Asia      Japan    2023-02-03   32695807   39924
#>  8 JPN      Asia      Japan    2023-02-02   32655883   45299
#>  9 JPN      Asia      Japan    2023-02-01   32610584   55537
#> 10 JPN      Asia      Japan    2023-01-31   32555047   47118
#> # … with 1,105 more rows, 61 more variables:
#> #   new_cases_smoothed <dbl>, total_deaths <dbl>,
#> #   new_deaths <dbl>, new_deaths_smoothed <dbl>,
#> #   total_cases_per_million <dbl>,
#> #   new_cases_per_million <dbl>,
#> #   new_cases_smoothed_per_million <dbl>,
#> #   total_deaths_per_million <dbl>, …
```


```r
covid %>% filter(location == "Japan") %>% drop_na(new_deaths_smoothed) %>%
  ggplot(aes(date, new_deaths_smoothed)) + geom_col() + 
    labs(title=paste("Covid-19 Death/Day in Japan as of ", Sys.Date()))
```

<img src="42-covid19_files/figure-html/unnamed-chunk-8-1.png" width="672" />

